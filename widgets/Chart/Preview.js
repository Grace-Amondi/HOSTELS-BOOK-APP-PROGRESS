// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/Chart/Preview.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"results-section" data-dojo-attach-point\x3d"resultsSection"\x3e\r\n\t\t\x3cdiv class\x3d"results-header" data-dojo-attach-point\x3d"resultsHeader" style\x3d"margin-bottom:15px;"\x3e\r\n\t\t\t\x3cdiv class\x3d"chart-title jimu-float-leading" data-dojo-attach-point\x3d"chartTitle"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"paging-section jimu-float-leading"\x3e\r\n\t\t\t\t\x3cul data-dojo-attach-point\x3d"pagingUl" data-dojo-attach-event\x3d"onclick:_onPagingUlClicked"\x3e\x3c/ul\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"zoomin jimu-float-trailing" data-dojo-attach-point\x3d"zoominIcon"\x3e\x3c/div\x3e\r\n\t\t\t\x3cdiv class\x3d"settings jimu-float-trailing" data-dojo-attach-point\x3d"settingsIcon"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"chart-section"\x3e\r\n\t\t\t\x3ctable cellpadding\x3d"0" cellspacing\x3d"0" style\x3d"width:100%;table-layout:fixed;"\x3e\r\n\t\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"15px;"\x3e\x3c/col\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"auto;"\x3e\x3c/col\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"15px;"\x3e\x3c/col\x3e\r\n\t\t    \t\x3c/colgroup\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item left-arrow arrow" data-dojo-attach-point\x3d"leftArrow" data-dojo-attach-event\x3d"onclick:_onLeftArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item chart-container" data-dojo-attach-point\x3d"chartContainer" dir\x3d"ltr" style\x3d"direction:ltr;overflow: hidden;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cdiv class\x3d"chart-section-item right-arrow arrow" data-dojo-attach-point\x3d"rightArrow" data-dojo-attach-event\x3d"onclick:_onRightArrowClicked"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"chart-description" data-dojo-attach-point\x3d"descriptionNode"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"noresults-section" data-dojo-attach-point\x3d"noresultsSection"\x3e\r\n\t\t${nls.noResults}\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/query dojo/_base/Color dojo/on dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/TooltipDialog dijit/popup dojo/Evented dojo/text!./Preview.html dojox/charting/Chart dojox/charting/axis2d/Default dojox/charting/axis2d/Invisible dojox/charting/plot2d/Columns dojox/charting/plot2d/Bars dojox/charting/plot2d/Lines dojox/charting/plot2d/Pie dojox/charting/plot2d/ClusteredColumns dojox/charting/plot2d/ClusteredBars dojox/charting/action2d/Tooltip dojox/charting/action2d/Highlight dojox/charting/action2d/MoveSlice dojox/charting/action2d/Magnify dojox/charting/SimpleTheme esri/symbols/jsonUtils esri/graphic esri/graphicsUtils esri/lang jimu/utils jimu/portalUrlUtils ./common/Parameters jimu/dijit/LoadingIndicator dojox/charting/action2d/MouseIndicator".split(" "),
function(R,g,p,r,E,D,G,S,T,U,V,W,L,X,Y,x,u,v,M,N,H,I,Z,aa,y,z,B,J,O,F,ba,ca,P,w,Q,da){return R([T,U,V,X],{baseClass:"jimu-widget-chart-preview",templateString:Y,charts:[],paramsDijits:[],tooltipDialogs:[],currentChartIndex:-1,layerDefinition:null,config:null,features:null,map:null,resultLayer:null,tempGraphics:null,maxHorLabelSpace:100,maxVerLabelSpace:100,folderUrl:"",maxPreviewFeaturesCount:20,pieScale:1.1,showZoomIcon:!1,isBigPreview:!1,fontColor:"#333333",tooltipColor:"green",floatNumberFieldDecimalPlace:null,
popupFieldInfosObj:null,postCreate:function(){this.inherited(arguments);this.map?this.own(G(document.body,"click",g.hitch(this,this._onDocumentBodyClick))):r.destroy(this.settingsIcon);this.showZoomIcon?this.own(G(this.zoominIcon,"click",g.hitch(this,function(){this.emit("zoomin")}))):r.destroy(this.zoominIcon);this.isBigPreview&&(this.chartContainer.style.maxHeight="auto",r.addClass(this.domNode,"big-preview"));this.zoominIcon.title=this.nls.enlarge;this.settingsIcon.title=this.nls.setting},destroy:function(){this.clear();
this.inherited(arguments)},resize:function(){0<=this.currentChartIndex&&this._recreateChart(this.currentChartIndex)},onClose:function(){},_calculateChartBox:function(){var a=r.getContentBox(this.domNode),b=r.getMarginBox(this.resultsHeader),c=r.getMarginBox(this.descriptionNode),a=a.h-b.h-c.h,b=60;a<b&&(b=a);r.setStyle(this.leftArrow,"height",b+"px");r.setStyle(this.rightArrow,"height",b+"px");r.setStyle(this.chartContainer,"height",a+"px");return r.getContentBox(this.chartContainer)},createCharts:function(a){try{this.loading.hide();
this.clear();if(!this.map){var b=this.maxPreviewFeaturesCount;a.features.length>b&&(a.features=a.features.slice(0,b))}r.setStyle(this.resultsSection,"display","block");r.setStyle(this.noresultsSection,"display","none");E(".chart-section-item",this.domNode).forEach(g.hitch(this,function(a){r.setStyle(a,"height",0)}));this.config=a.config;this.features=a.features;this.layerDefinition=a.layerDefinition;this.resultLayer=a.resultLayer;this._updatePopupFieldInfos();this._calculateDecimalPlaceForFloatField();
this.chartTitle.innerHTML=w.stripHTML(this.config.name||"");this.chartTitle.title=this.chartTitle.innerHTML;this.descriptionNode.innerHTML=w.stripHTML(this.config.description||"");r.setStyle(this.resultsSection,"display","block");for(var c=0,e,b=[],d=this._getTypes(a.config),q=this._calculateChartBox(),h=q.w+"px",m=q.h+"px",c=0;c<d.length;c++){e=r.create("div",{"class":"chart-div",style:{width:h,height:m}},this.chartContainer);b.push(e);var n=r.toDom("\x3cli class\x3d'paging-li'\x3e\x3ca class\x3d'paging-a'\x3e\x3c/a\x3e\x3c/li\x3e");
r.place(n,this.pagingUl)}var f=a.config;e=null;"feature"===f.mode?e=this._createFeatureModeCharts(a,b):"category"===f.mode?e=this._createCategoryModeCharts(a,b):"count"===f.mode?e=this._createCountModeCharts(a,b):"field"===f.mode&&(e=this._createFieldModeCharts(a,b));this.charts=e.charts;this.paramsDijits=e.paramsDijits;this.tooltipDialogs=p.map(this.paramsDijits,g.hitch(this,function(a){var b=r.create("div");a.placeAt(b);return new W({content:b})}));this.map&&p.forEach(this.paramsDijits,g.hitch(this,
function(a,b){this.own(G(a,"change",g.hitch(this,function(){a.showShelter();this._recreateChart(b);a.hideShelter()})))}));this._showChart(0);0===a.features.length&&(r.setStyle(this.resultsSection,"display","none"),r.setStyle(this.noresultsSection,"display","block"))}catch(l){console.error(l)}},_updatePopupFieldInfos:function(){this.popupFieldInfosObj={};var a=null,b=w.removeSuffixSlashes(this.config.url),b=Q.removeProtocol(b);if(this.map&&this.map.itemInfo&&this.map.itemInfo.itemData){var c=this.map.itemInfo.itemData.operationalLayers,
e=b.split("/"),d=parseInt(e[e.length-1],10);c&&0<c.length&&p.some(c,g.hitch(this,function(c){var e=c.url;if(e&&(e=w.removeSuffixSlashes(e),e=Q.removeProtocol(e),0<=b.indexOf(e)))if(b===e){if(c.popupInfo&&c.popupInfo.fieldInfos)return a=c.popupInfo.fieldInfos,!0}else if(b.length>e.length&&c.layers&&0<=d&&(c=c[d])&&c.popupInfo&&c.popupInfo.fieldInfos)return a=c.popupInfo.fieldInfos,!0;return!1}))}a&&0<a.length&&p.forEach(a,g.hitch(this,function(a){this.popupFieldInfosObj[a.fieldName]=a}))},_calculateDecimalPlaceForFloatField:function(){this.floatNumberFieldDecimalPlace=
{};var a=[];this.config.labelField&&a.push(this.config.labelField);this.config.categoryField&&a.push(this.config.categoryField);this.config.valueFields&&(a=a.concat(this.config.valueFields));var b=p.filter(a,g.hitch(this,function(a){return this._isFloatNumberField(a)})),c={};p.forEach(b,g.hitch(this,function(a){c[a]=[]}));(a=this.features)&&0<a.length&&p.forEach(a,g.hitch(this,function(a){var d=a.attributes;d&&p.forEach(b,g.hitch(this,function(a){var b=d[a];"number"===typeof b&&c[a].push(b)}))}));
p.forEach(b,g.hitch(this,function(a){this.floatNumberFieldDecimalPlace[a]=0;var b=c[a];if(0<b.length)try{var e=this._getBestDecimalPlace(b);this.floatNumberFieldDecimalPlace[a]=e}catch(h){this.floatNumberFieldDecimalPlace[a]=0,console.error(h)}this.popupFieldInfosObj&&(b=this.popupFieldInfosObj[a])&&b.format&&0<=b.format.places&&(this.floatNumberFieldDecimalPlace[a]=b.format.places)}))},_onDocumentBodyClick:function(a){if(0<=this.currentChartIndex&&this.tooltipDialogs){var b=this.tooltipDialogs[this.currentChartIndex];
if(b){var c=!!b.isOpendNow;this._hideAllTooltipDialogs();var e=a.target||a.srcElement;e===this.leftArrow||e===this.rightArrow||r.hasClass(e,"paging-a")||r.hasClass(e,"paging-li")||(e===this.settingsIcon?c?this._hideTooltipDialog(b):this._showTooltipDialog(b):(a=e===b.domNode,e=r.isDescendant(e,b.domNode),a||e?c?this._showTooltipDialog(b):this._hideTooltipDialog(b):this._hideTooltipDialog(b)))}else this._hideAllTooltipDialogs()}else this._hideAllTooltipDialogs()},clear:function(){this.resultLayer=
this.layerDefinition=this.features=this.config=null;this.chartTitle.innerHTML="";this.chartTitle.title="";this.descriptionNode.innerHTML="";this.currentChartIndex=-1;this.popupFieldInfosObj=this.floatNumberFieldDecimalPlace=null;E(".chart-div",this.chartContainer).style({display:"none"});E("li",this.pagingUl).removeClass("selected");this._hideAllTooltipDialogs();this.charts||(this.charts=[]);this.paramsDijits||(this.paramsDijits=[]);this.tooltipDialogs||(this.tooltipDialogs=[]);for(var a=0;a<this.charts.length;a++)this.charts[a]&&
this.charts[a].destroy(),this.charts[a]=null,this.paramsDijits[a]&&this.paramsDijits[a].destroy(),this.paramsDijits[a]=null,this.tooltipDialogs[a]&&this.tooltipDialogs[a].destroy(),this.tooltipDialogs[a]=null;this.charts=[];this.paramsDijits=[];this.tooltipDialogs=[];r.empty(this.pagingUl);r.empty(this.chartContainer);r.setStyle(this.resultsSection,"display","none");r.setStyle(this.noresultsSection,"display","none")},_recreateChart:function(a){if(0>a||a!==this.currentChartIndex||!this.charts||!this.charts[a])return null;
this.loading.show();var b=E(".chart-div",this.chartContainer)[a];r.setStyle(b,"display","block");var c=this._calculateChartBox();r.setStyle(b,"width",c.w+"px");r.setStyle(b,"height",c.h+"px");b=this.charts[a].createSelf;this.charts[a].createSelf=null;this.charts[a].destroy();this.charts[a]=null;this.charts[a]=b();this.loading.hide();return this.charts[a]},_showChart:function(a){this.currentChartIndex=-1;var b=E(".chart-div",this.chartContainer);b.style({display:"none"});var c=E("li",this.pagingUl);
c.removeClass("selected");if(!(0>a)){if(b=b[a])this.currentChartIndex=a,r.setStyle(b,"display","block");(c=c[a])&&r.addClass(c,"selected");if(!this.isBigPreview&&(c=null,this.charts&&0<this.charts.length&&(c=this.charts[a]))){var e=this._calculateChartBox(),d=r.getContentBox(b);if(e.w!==d.w||e.h!==d.h)this.loading.show(),S("svg")?(r.setStyle(b,"width",e.w+"px"),r.setStyle(b,"height",e.h+"px"),(a=c.getPlot("default"))&&"dojox.charting.plot2d.Pie"===a.declaredClass&&a.opt&&(a.opt.radius=Math.floor(Math.min(e.w,
e.h)/2/this.pieScale)-3),c.resize(e.w,e.h)):this._recreateChart(a),this.loading.hide()}}},_hideAllTooltipDialogs:function(){this.tooltipDialogs&&0<this.tooltipDialogs.length&&p.forEach(this.tooltipDialogs,g.hitch(this,function(a){this._hideTooltipDialog(a)}))},_hideTooltipDialog:function(a){a&&(L.close(a),a.isOpendNow=!1)},_showTooltipDialog:function(a){a&&(L.open({popup:a,around:this.settingsIcon}),a.isOpendNow=!0)},_onPagingUlClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();
a=a.target||a.srcElement;if("a"===a.tagName.toLowerCase()){var b=E("a",this.pagingUl);a=p.indexOf(b,a);0<=a&&this._showChart(a)}},_onLeftArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex-1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_onRightArrowClicked:function(a){a.stopPropagation();this._hideAllTooltipDialogs();a=(this.currentChartIndex+1+this.charts.length)%this.charts.length;0<=a&&this._showChart(a)},_getHighLightMarkerSymbol:function(){var a=
F.fromJson(this.config.symbol),a=Math.max(a.size||0,a.width||0,a.height,18),a=a+1,b=F.fromJson({color:[255,255,255,0],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSSquare",outline:{color:[0,0,128,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}});b.setSize(a);b.outline.setColor(new D(this.config.highLightColor));return b},_getHighLightLineSymbol:function(){var a=F.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});a.setColor(new D(this.config.highLightColor));
return a},_getHighLightFillSymbol:function(){var a=F.fromJson(this.config.symbol),b=F.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"});b.setColor(new D(this.config.highLightColor));a.setOutline(b);return a},_zoomToGraphics:function(a){if(this.resultLayer&&this.resultLayer.visible&&a&&0<a.length){var b=null;try{var c=p.filter(a,function(a){return!!a.geometry});0<c.length&&(b=ca.graphicsExtent(c))}catch(e){console.error(e)}if(b)this.map.setExtent(b.expand(1.4));else if(a=
(a=a[0])&&a.geometry)b=g.hitch(this,function(a){var b=this.map.getNumLevels(),c=this.map.getLevel();this.map.setLevel(Math.max(c,Math.floor(2*b/3))).then(g.hitch(this,function(){this.map.centerAt(a)}))}),"point"===a.type?b(a):"multipoint"===a.type&&1===a.points.length&&b(a.getPoint(0))}},_removeTempGraphics:function(){if(this.resultLayer&&this.tempGraphics&&0<this.tempGraphics.length)for(;0<this.tempGraphics.length;)this.resultLayer.remove(this.tempGraphics[0]),this.tempGraphics.splice(0,1);this.tempGraphics=
null},_mouseOverChartItem:function(a){this._removeTempGraphics();if(this.resultLayer&&this.resultLayer.visible){var b=w.getTypeByGeometryType(this.layerDefinition.geometryType),c=null;if("point"===b)c=this._getHighLightMarkerSymbol(),this.tempGraphics=[],p.forEach(a,g.hitch(this,function(a){a=new ba(a.geometry,c);this.tempGraphics.push(a);this.resultLayer.add(a)}));else if("polyline"===b||"polygon"===b)c="polyline"===b?this._getHighLightLineSymbol():this._getHighLightFillSymbol(),p.forEach(a,g.hitch(this,
function(a){a.setSymbol(c)})),this.features.length!==a.length&&"polygon"===b&&(p.forEach(a,g.hitch(this,function(a){this.resultLayer.remove(a)})),p.forEach(a,g.hitch(this,function(a){this.resultLayer.add(a)})))}},_mouseOutChartItem:function(){this._removeTempGraphics();this.resultLayer&&p.forEach(this.resultLayer.graphics,g.hitch(this,function(a){a.setSymbol(null)}))},_isNumber:function(a){return"[object number]"===Object.prototype.toString.call(a).toLowerCase()},_tryLocaleNumber:function(a,b){var c=
a;if(P.isDefined(a)&&isFinite(a))try{var e;if(b&&this._isNumberField(b)){var d=this.popupFieldInfosObj[b];e=d&&g.exists("format.places",d)?w.localizeNumberByFieldInfo(a,d):w.localizeNumber(a)}else e=a;"string"===typeof e&&(c=e)}catch(q){console.error(q)}return c+""},_getBestDisplayValue:function(a,b){var c=this._tryLocaleNumber(b,a);if(this.layerDefinition.typeIdField===a){var e=this.layerDefinition.types;if(e&&0<e.length&&(e=p.filter(e,g.hitch(this,function(a){return a.id===b})),0<e.length))return c=
e[0].name}(e=this._getFieldInfo(a))&&e.domain&&(e=e.domain.codedValues)&&0<e.length&&p.some(e,function(a){return a.code===b?(c=a.name,!0):!1});return c},_getFieldAliasArray:function(a){return p.map(a,g.hitch(this,function(a){return this._getFieldAlias(a)}))},_getFieldAlias:function(a){var b=a;(a=this._getFieldInfo(a))&&(b=a.alias||b);return b},_getFieldInfo:function(a){if(this.layerDefinition)for(var b=this.layerDefinition.fields,c=0;c<b.length;c++)if(b[c].name===a)return b[c];return null},_isNumberField:function(a){var b=
["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];return p.some(this.layerDefinition.fields,g.hitch(this,function(c){return c.name===a&&0<=b.indexOf(c.type)}))},_isFloatNumberField:function(a){var b=["esriFieldTypeSingle","esriFieldTypeDouble"];return p.some(this.layerDefinition.fields,g.hitch(this,function(c){return c.name===a&&0<=b.indexOf(c.type)}))},_isDateField:function(a){return(a=this._getFieldInfo(a))?"esriFieldTypeDate"===a.type:!1},_getBestDecimalPlace:function(a){var b=
0,c={};p.forEach(a,function(a){a=a.toString().split(".");var b=null;1===a.length?b=0:2===a.length&&(b=a[1].length);null!==b&&(c[b]=void 0===c[b]?1:c[b]+1)});a=null;for(var e in c){e=parseInt(e,10);var d=c[e];a?d>a.value&&(a={key:e,value:d}):a={key:e,value:d}}a&&(b=parseInt(a.key,10));return b},_getFloatNumberFieldDecimalPlace:function(a){var b=0;this.floatNumberFieldDecimalPlace&&(a=this.floatNumberFieldDecimalPlace[a],"number"===typeof a&&(b=a));return b},_getBestValueForFloatNumberField:function(a,
b){var c=this._getFloatNumberFieldDecimalPlace(b),c=a.toFixed(c);return parseFloat(c)},_getColors:function(a,b){var c=[],e=g.clone(a);if(2===e.colors.length)c=this._createGradientColors(e.colors[0],e.colors[e.colors.length-1],b);else{for(var d=Math.ceil(b/e.colors.length),q=0;q<d;q++)c=c.concat(e.colors);c=c.slice(0,b)}return c},_createPieTheme:function(a,b){var c=g.clone(a).colors,e=[];if(2===c.length)e=this._createGradientColors(c[0],c[c.length-1],b);else if(b<=c.length)e=c;else{var d=p.map(c,function(a){return new D(a)}),
q,h,c=Math.ceil(b/c.length);h=.1*Math.floor(c/2);q=Math.max(1-h,.5);h=(Math.min(1+h,1.5)-q)/c;var m=q;for(q=0;q<c;q++)p.forEach(d,g.hitch(this,function(a){var b=Math.min(Math.floor(a.r*m),255),c=Math.min(Math.floor(a.g*m),255);a=Math.min(Math.floor(a.b*m),255);var d=new D;d.r=b;d.g=c;d.b=a;b=d.toHex();e.push(b)})),m+=h;e=e.slice(0,b)}d={series:{stroke:{width:1.5,color:"#fff"}},seriesThemes:p.map(e,g.hitch(this,function(a){return{fill:a}}))};return new O(d)},_createGradientColors:function(a,b,c){var e=
[];a=new D(a);var d=new D(b);b=(d.r-a.r)/c;for(var g=(d.g-a.g)/c,d=(d.b-a.b)/c,h=new D,m=0,n=0,f=0,l=0;l<c;l++)m=parseInt(a.r+b*l,10),n=parseInt(a.g+g*l,10),f=parseInt(a.b+d*l,10),h.setColor([m,n,f]),e.push(h.toHex());return e},_getTypes:function(a){var b=[];a.column&&b.push("column");a.pie&&b.push("pie");a.bar&&b.push("bar");a.line&&b.push("line");return b},_calculateHorizontalRotation:function(a,b){var c=r.getContentBox(a),e=0,d=0;p.forEach(b,g.hitch(this,function(a){d=Math.max(d,a.text.length)}));
Math.floor((c.w-100)/b.length)<11.9*d&&(e=-45);return e},_createParamsDijit:function(a,b){return new da({isInWidget:this.map?!0:!1,imagesUrl:this.folderUrl+"common/images",type:a,nls:this.nls,config:b})},_createColumnParamsDijit:function(a){return this._createParamsDijit("column",a.column)},_createBarParamsDijit:function(a){return this._createParamsDijit("bar",a.bar)},_createLineParamsDijit:function(a){return this._createParamsDijit("line",a.line)},_createPieParamsDijit:function(a){return this._createParamsDijit("pie",
a.pie)},_getRecreateChartFunction:function(a,b,c,e,d){return g.hitch(this,a,b,c,e,d)},_createFeatureModeCharts:function(a,b){var c=[],e=[],d=a.config,q=d.labelField,h=d.valueFields,m=this._getTypes(d),n="des"!==d.sortOrder,f=[],f=p.map(a.features,g.hitch(this,function(a){var b=a.attributes;a={category:b[q],valueFields:[],dataFeatures:[a]};a.valueFields=p.map(h,g.hitch(this,function(a){return b[a]}));return a}));n?f.sort(function(a,b){return a.category<b.category?-1:a.category>b.category?1:0}):f.sort(function(a,
b){return a.category<b.category?1:a.category>b.category?-1:0});this._isDateField(q)&&0<f.length&&p.map(f,g.hitch(this,function(a){var b=a.category;"number"===typeof b&&0<b&&(a.category=w.localizeDate(new Date(b)))}));p.forEach(m,g.hitch(this,function(l,k){try{var h=b[k],g=null,C=null;"column"===l?(C=this._createColumnParamsDijit(d),g=this._createFeatureModeColumnChart(a,h,f,C)):"bar"===l?(C=this._createBarParamsDijit(d),g=this._createFeatureModeBarChart(a,h,f,C)):"line"===l?(C=this._createLineParamsDijit(d),
g=this._createFeatureModeLineChart(a,h,f,C)):"pie"===l&&(C=this._createPieParamsDijit(d),g=this._createFeatureModePieChart(a,h,f,C));e.push(C);c.push(g)}catch(K){console.error(K)}}));return{charts:c,paramsDijits:e}},_createFeatureModeColumnChart:function(a,b,c,e){return this._createCategoryModeColumnChart(a,b,c,e)},_createFeatureModeBarChart:function(a,b,c,e){return this._createCategoryModeBarChart(a,b,c,e)},_createFeatureModeLineChart:function(a,b,c,e){return this._createCategoryModeLineChart(a,
b,c,e)},_createFeatureModePieChart:function(a,b,c,e){return this._createCategoryModePieChart(a,b,c,e)},_createCategoryModeCharts:function(a,b){var c=[],e=[],d=a.config,q=d.categoryField,h=d.valueFields,m=this._getTypes(d),n="des"!==d.sortOrder,f=[],l=a.config.operation,k={};p.forEach(a.features,g.hitch(this,function(a){var b=a.attributes[q],c=null;k.hasOwnProperty(b)?(c=k[b],c.dataFeatures.push(a)):(c={dataFeatures:[a]},k[b]=c)}));var t=null,A;for(A in k)t=k[A],this._isNumberField(q)&&P.isDefined(A)&&
(A=parseFloat(A)),t.valueFields=p.map(h,g.hitch(this,function(a){var b=p.map(t.dataFeatures,g.hitch(this,function(b){return b.attributes[a]})),c=0;"max"===l?c=-Infinity:"min"===l&&(c=Infinity);var d=0;p.forEach(b,g.hitch(this,function(a){this._isNumber(a)&&(d++,"average"===l||"sum"===l?c+=a:"max"===l?c=Math.max(c,a):"min"===l&&(c=Math.min(c,a)))}));0<d?"average"===l&&(c/=d):c=0;return c})),f.push({category:A,valueFields:t.valueFields,dataFeatures:t.dataFeatures});n?f.sort(function(a,b){return a.category<
b.category?-1:a.category>b.category?1:0}):f.sort(function(a,b){return a.category<b.category?1:a.category>b.category?-1:0});this._isDateField(q)&&0<f.length&&p.map(f,g.hitch(this,function(a){var b=a.category;b&&0<parseInt(b,10)&&(a.category=w.localizeDate(new Date))}));f=p.filter(f,g.hitch(this,function(a){var b=!1;a=a.category;"number"===typeof a&&(b=isNaN(a));return!b}));"sum"!==l&&"average"!==l||p.forEach(f,g.hitch(this,function(a){p.forEach(h,g.hitch(this,function(b,c){if(this._isFloatNumberField(b)){var d=
a.valueFields[c],d=this._getBestValueForFloatNumberField(d,b);a.valueFields[c]=d}}))}));p.forEach(m,g.hitch(this,function(l,k){try{var h=b[k],g=null,t=null;"column"===l?(t=this._createColumnParamsDijit(d),g=this._createCategoryModeColumnChart(a,h,f,t)):"bar"===l?(t=this._createBarParamsDijit(d),g=this._createCategoryModeBarChart(a,h,f,t)):"line"===l?(t=this._createLineParamsDijit(d),g=this._createCategoryModeLineChart(a,h,f,t)):"pie"===l&&(t=this._createPieParamsDijit(d),g=this._createCategoryModePieChart(a,
h,f,t));e.push(t);c.push(g)}catch(fa){console.error(fa)}}));return{charts:c,paramsDijits:e}},_bindCategoryModeChartEvent:function(a,b){this.map&&a.connectToPlot("default",g.hitch(this,function(a){var c="onmouseout"===a.type,d="onclick"===a.type;if("onmouseover"===a.type||c||d)c=b[a.index].dataFeatures,"onmouseover"===a.type?this._mouseOverChartItem(c):"onmouseout"===a.type?this._mouseOutChartItem(c):"onclick"===a.type&&this._zoomToGraphics(c)}))},_createCategoryModeColumnChart:function(a,b,c,e){for(var d=
a.config,q=d.valueFields,h=this._getFieldAliasArray(q),m=d.labelField||d.categoryField,d=e.getConfig(),n=[],f=[],l=0;l<q.length;l++)f.push([]);p.forEach(c,g.hitch(this,function(a,b){var c=this._getBestDisplayValue(m,a.category);n.push({value:b+1,text:c});for(var d=0;d<a.valueFields.length;d++){var e=a.valueFields[d],l=h[d],k=this.nls.category,g=this._getBestDisplayValue(q[d],e);f[d].push({y:e,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
k+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+c+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+l+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+g+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}}));if(this.isBigPreview&&0<n.length){var k=16.5*n.length+100;b.clientWidth<k&&(b.style.width=k+"px")}k=new x(b);k.setTheme(this._createTransparentTheme());
k.addPlot("default",{type:Z,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});l=this._calculateHorizontalRotation(b,n);k.addAxis("x",{type:!1===d.horizontalAxis?v:u,natural:!0,labels:n,rotation:l,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});k.addAxis("y",{type:!1===d.verticalAxis?v:u,vertical:!0,natural:!0,includeZero:!0});d=this._getColors(d,f.length);for(l=0;l<f.length;l++)k.addSeries(q[l],f[l],{stroke:{color:d[l%d.length]},fill:d[l%d.length]});new B(k,"default");
new z(k,"default");new y(k,"default");k.render();this._bindCategoryModeChartEvent(k,c);k.createSelf=this._getRecreateChartFunction(this._createCategoryModeColumnChart,a,b,c,e);return k},_createCategoryModeBarChart:function(a,b,c,e){for(var d=a.config,q=d.valueFields,h=this._getFieldAliasArray(q),m=d.labelField||d.categoryField,d=e.getConfig(),n=[],f=[],l=0;l<q.length;l++)f.push([]);p.forEach(c,g.hitch(this,function(a,b){var c=this._getBestDisplayValue(m,a.category);n.push({value:b+1,text:c});for(var d=
0;d<a.valueFields.length;d++){var e=a.valueFields[d],l=h[d],k=this.nls.category,g=this._getBestDisplayValue(q[d],e);f[d].push({y:e,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+k+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+c+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
l+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+g+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}}));this.isBigPreview&&0<n.length&&(l=16.5*n.length,b.clientHeight<l&&(b.style.height=l+"px"));var k=new x(b);k.setTheme(this._createTransparentTheme());k.addPlot("default",{type:aa,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});k.addAxis("x",{type:!1===d.verticalAxis?v:u,vertical:!0,natural:!0,labels:n,
fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});k.addAxis("y",{type:!1===d.horizontalAxis?v:u,natural:!0,includeZero:!0});d=this._getColors(d,f.length);for(l=0;l<f.length;l++)k.addSeries(q[l],f[l],{stroke:{color:d[l%d.length]},fill:d[l%d.length]});new B(k,"default");new z(k,"default");new y(k,"default");k.render();this._bindCategoryModeChartEvent(k,c);k.createSelf=this._getRecreateChartFunction(this._createCategoryModeBarChart,a,b,c,e);return k},_createCategoryModeLineChart:function(a,
b,c,e){for(var d=a.config,q=d.valueFields,h=this._getFieldAliasArray(q),m=d.labelField||d.categoryField,d=e.getConfig(),n=[],f=[],l=0;l<q.length;l++)f.push([]);p.forEach(c,g.hitch(this,function(a,b){var c=this._getBestDisplayValue(m,a.category);n.push({value:b+1,text:c});for(var d=0;d<a.valueFields.length;d++){var e=parseFloat(a.valueFields[d]),l=h[d],k=this.nls.category,g=this._getBestDisplayValue(q[d],e),e=isNaN(e)?0:e;f[d].push({y:e,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+
this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+k+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+c+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+l+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+g+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}}));
if(this.isBigPreview&&0<n.length){var k=16.5*n.length+100;b.clientWidth<k&&(b.style.width=k+"px")}k=new x(b);k.setTheme(this._createTransparentTheme());k.addPlot("default",{type:H,markers:!0,tension:"X"});l=this._calculateHorizontalRotation(b,n);k.addAxis("x",{type:!1===d.horizontalAxis?v:u,natural:!0,includeZero:!0,labels:n,rotation:l,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});k.addAxis("y",{type:!1===d.verticalAxis?v:u,vertical:!0,natural:!0});d=this._getColors(d,f.length);
for(l=0;l<f.length;l++)k.addSeries(q[l],f[l],{stroke:{color:d[l%d.length]},fill:d[l%d.length]});new J(k,"default");new z(k,"default");new y(k,"default");k.render();this._bindCategoryModeChartEvent(k,c);k.createSelf=this._getRecreateChartFunction(this._createCategoryModeLineChart,a,b,c,e);return k},_createCategoryModePieChart:function(a,b,c,e){var d=a.config,q=d.valueFields,h=this._getFieldAliasArray(q),m=d.labelField||d.categoryField,d=e.getConfig(),n=r.getContentBox(b),f=Math.floor(Math.min(n.w,
n.h)/2/this.pieScale)-3,l=[],k=[],t=[];p.forEach(q,g.hitch(this,function(a,b){k.push([]);var d=0;p.forEach(c,g.hitch(this,function(a){d+=Math.abs(a.valueFields[b])}));t.push(d)}));p.forEach(c,g.hitch(this,function(a,b){var d=this._getBestDisplayValue(m,a.category);l.push({value:b+1,text:d});for(var c=0;c<a.valueFields.length;c++){var e=a.valueFields[c],f=q[c],g=h[c],n=this._tryLocaleNumber((e/t[c]*100).toFixed(1))+"%",p=this.nls.category,f=this._getBestDisplayValue(f,e);k[c].push({y:Math.abs(e),text:d,
tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+p+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+d+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+g+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+n+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}}));var n=new x(b),A=this._createPieTheme(d,c.length);A.plotarea.fill="transparent";A.chart.fill="transparent";n.setTheme(A);n.addPlot("default",{type:I,radius:f,labels:!!d.label});for(d=0;d<k.length;d++)n.addSeries(q[d],k[d]);new B(n,"default");new z(n,"default");new y(n,"default");n.render();this._bindCategoryModeChartEvent(n,
c);n.createSelf=this._getRecreateChartFunction(this._createCategoryModePieChart,a,b,c,e);return n},_createCountModeCharts:function(a,b){var c=[],e=[],d=a.config,q=this._getTypes(d),h=d.categoryField,m="des"!==d.sortOrder,n={};p.forEach(a.features,g.hitch(this,function(a){var b=a.attributes[h],c=null;n.hasOwnProperty(b)?(c=n[b],c.count++,c.dataFeatures.push(a)):(c={count:1,dataFeatures:[a]},n[b]=c)}));var f=[],l=null,k;for(k in n)l=n[k],this._isNumberField(h)&&(k=parseFloat(k)),f.push({fieldValue:k,
count:l.count,dataFeatures:l.dataFeatures});m?f.sort(function(a,b){return a.fieldValue<b.fieldValue?-1:a.fieldValue>b.fieldValue?1:0}):f.sort(function(a,b){return a.fieldValue<b.fieldValue?1:a.fieldValue>b.fieldValue?-1:0});this._isDateField(h)&&0<f.length&&p.forEach(f,g.hitch(this,function(a){if(a.fieldValue){var b=parseInt(a.fieldValue,10);0<b&&(a.fieldValue=w.localizeDate(new Date(b)))}}));p.forEach(q,g.hitch(this,function(l,k){try{var g=b[k],h=null,m=null;"column"===l?(m=this._createColumnParamsDijit(d),
h=this._createCountModeColumnChart(a,g,f,m)):"bar"===l?(m=this._createBarParamsDijit(d),h=this._createCountModeBarChart(a,g,f,m)):"line"===l?(m=this._createLineParamsDijit(d),h=this._createCountModeLineChart(a,g,f,m)):"pie"===l&&(m=this._createPieParamsDijit(d),h=this._createCountModePieChart(a,g,f,m));e.push(m);c.push(h)}catch(ea){console.error(ea)}}));return{charts:c,paramsDijits:e}},_bindCountModeChartEvent:function(a,b){this.map&&a.connectToPlot("default",g.hitch(this,function(a){var c="onmouseout"===
a.type,d="onclick"===a.type;if("onmouseover"===a.type||c||d)c=b[a.index].dataFeatures,"onmouseover"===a.type?this._mouseOverChartItem(c):"onmouseout"===a.type?this._mouseOutChartItem(c):"onclick"===a.type&&this._zoomToGraphics(c)}))},_createCountModeColumnChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),h=e.getConfig(),m=[],n=[];p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=a.fieldValue,f=w.localizeNumber(c),e=this._getBestDisplayValue(d,e);m.push({value:b+1,
text:e});n.push({y:c,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+q+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+e+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+this.nls.count+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));if(this.isBigPreview&&0<m.length){var f=16.5*m.length+100;b.clientWidth<f&&(b.style.width=f+"px")}f=new x(b);f.setTheme(this._createTransparentTheme());f.addPlot("default",{type:M,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});var l=this._calculateHorizontalRotation(b,m);f.addAxis("x",{type:!1===h.horizontalAxis?v:u,natural:!0,labels:m,rotation:l,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,
majorTickStep:1});f.addAxis("y",{type:!1===h.verticalAxis?v:u,vertical:!0,includeZero:!0,natural:!0});h=this._getColors(h,1);f.addSeries("default",n,{stroke:{color:h[0]},fill:h[0]});new B(f,"default");new z(f,"default");new y(f,"default");f.render();this._bindCountModeChartEvent(f,c);f.createSelf=this._getRecreateChartFunction(this._createCountModeColumnChart,a,b,c,e);return f},_createCountModeBarChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),h=e.getConfig(),m=[],n=
[];p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=a.fieldValue,f=w.localizeNumber(c),e=this._getBestDisplayValue(d,e);m.push({value:b+1,text:e});n.push({y:c,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+q+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
e+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+this.nls.count+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));if(this.isBigPreview&&0<m.length){var f=16.5*m.length;b.clientHeight<f&&(b.style.height=f+"px")}f=new x(b);f.setTheme(this._createTransparentTheme());f.addPlot("default",{type:N,enableCache:!0,markers:!0,
gap:10,minBarSize:2,maxBarSize:60});f.addAxis("x",{type:!1===h.verticalAxis?v:u,vertical:!0,natural:!0,labels:m,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});f.addAxis("y",{type:!1===h.horizontalAxis?v:u,includeZero:!0,natural:!0});h=this._getColors(h,1);f.addSeries("default",n,{stroke:{color:h[0]},fill:h[0]});new B(f,"default");new z(f,"default");new y(f,"default");f.render();this._bindCountModeChartEvent(f,c);f.createSelf=this._getRecreateChartFunction(this._createCountModeBarChart,
a,b,c,e);return f},_createCountModeLineChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),h=e.getConfig(),m=[],n=[];p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=a.fieldValue,f=w.localizeNumber(c),e=this._getBestDisplayValue(d,e);m.push({value:b+1,text:e});n.push({y:c,text:"",tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
q+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+e+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+this.nls.count+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));if(this.isBigPreview&&0<m.length){var f=16.5*m.length+100;b.clientWidth<f&&(b.style.width=f+"px")}f=new x(b);
f.setTheme(this._createTransparentTheme());f.addPlot("default",{type:H,markers:!0,tension:"X"});var l=this._calculateHorizontalRotation(b,m);f.addAxis("x",{type:!1===h.horizontalAxis?v:u,natural:!0,includeZero:!0,labels:m,rotation:l,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});f.addAxis("y",{type:!1===h.verticalAxis?v:u,vertical:!0,natural:!0});h=this._getColors(h,1);f.addSeries("default",n,{stroke:{color:h[0]},fill:h[0]});new J(f,"default");new z(f,"default");new y(f,
"default");f.render();this._bindCountModeChartEvent(f,c);f.createSelf=this._getRecreateChartFunction(this._createCountModeLineChart,a,b,c,e);return f},_createCountModePieChart:function(a,b,c,e){var d=a.config.categoryField,q=this._getFieldAlias(d),h=e.getConfig(),m=r.getContentBox(b),m=Math.floor(Math.min(m.w,m.h)/2/this.pieScale)-3,n=[],f=[],l=0;p.forEach(c,g.hitch(this,function(a){l+=a.count}));p.forEach(c,g.hitch(this,function(a,b){var c=a.count,e=this._getBestDisplayValue(d,a.fieldValue),k=this._tryLocaleNumber((c/
l*100).toFixed(1))+"%",g=w.localizeNumber(c),h=this.nls.count;n.push({value:b+1,text:e});f.push({text:e,y:c,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+q+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+e+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
h+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+g+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+k+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));var k=new x(b),t=this._createPieTheme(h,c.length);t.plotarea.fill="transparent";t.chart.fill="transparent";k.setTheme(t);k.addPlot("default",{type:I,radius:m,labels:!!h.label});k.addSeries("default",f);new B(k,"default");
new z(k,"default");new y(k,"default");k.render();this._bindCountModeChartEvent(k,c);k.createSelf=this._getRecreateChartFunction(this._createCountModePieChart,a,b,c,e);return k},_createFieldModeCharts:function(a,b){var c=[],e=[],d=a.config,q=this._getTypes(d),h=d.valueFields,m=d.operation,n=p.map(a.features,g.hitch(this,function(a){return a.attributes})),f={};p.forEach(h,g.hitch(this,function(a){f[a]=0;"max"===m?f[a]=-Infinity:"min"===m&&(f[a]=Infinity);var b=0;p.forEach(n,g.hitch(this,function(c){c=
c[a];this._isNumber(c)&&(b++,f.hasOwnProperty(a)?"average"===m||"sum"===m?f[a]+=c:"max"===m?f[a]=Math.max(f[a],c):"min"===m&&(f[a]=Math.min(f[a],c)):f[a]=c)}));0<b?"average"===m&&(f[a]/=b):f[a]=0}));"sum"!==m&&"average"!==m||p.forEach(h,g.hitch(this,function(a){f.hasOwnProperty(a)&&this._isFloatNumberField(a)&&(f[a]=this._getBestValueForFloatNumberField(f[a],a))}));p.forEach(q,g.hitch(this,function(l,k){try{var g=b[k],h=null,m=null;"column"===l?(m=this._createColumnParamsDijit(d),h=this._createFieldModeColumnChart(a,
g,f,m)):"bar"===l?(m=this._createBarParamsDijit(d),h=this._createFieldModeBarChart(a,g,f,m)):"line"===l?(m=this._createLineParamsDijit(d),h=this._createFieldModeLineChart(a,g,f,m)):"pie"===l&&(m=this._createPieParamsDijit(d),h=this._createFieldModePieChart(a,g,f,m));e.push(m);c.push(h)}catch(K){console.error(K)}}));return{charts:c,paramsDijits:e}},_bindFieldModeChartEvent:function(a){this.map&&a.connectToPlot("default",g.hitch(this,function(a){var b="onmouseout"===a.type,e="onclick"===a.type;if("onmouseover"===
a.type||b||e)b=this.features,"onmouseover"===a.type?this._mouseOverChartItem(b):"onmouseout"===a.type?this._mouseOutChartItem(b):"onclick"===a.type&&this._zoomToGraphics(b)}))},_createFieldModeColumnChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),h=e.getConfig(),m=[],n=[];p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],f=w.localizeNumber(e);m.push({value:b+1,text:d});n.push({y:e,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+
this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+d+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));d=new x(b);d.setTheme(this._createTransparentTheme());d.addPlot("default",{type:M,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});var f=
this._calculateHorizontalRotation(b,m);d.addAxis("x",{type:!1===h.horizontalAxis?v:u,natural:!0,labels:m,rotation:f,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});d.addAxis("y",{type:!1===h.verticalAxis?v:u,vertical:!0,includeZero:!0,natural:!0});h=this._getColors(h,1);d.addSeries("default",n,{stroke:{color:h[0]},fill:h[0]});new B(d,"default");new z(d,"default");new y(d,"default");d.render();this._bindFieldModeChartEvent(d);d.createSelf=this._getRecreateChartFunction(this._createFieldModeColumnChart,
a,b,c,e);return d},_createFieldModeBarChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),h=e.getConfig(),m=[],n=[];p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],f=w.localizeNumber(e);m.push({value:b+1,text:d});n.push({y:e,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
d+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));d=new x(b);d.setTheme(this._createTransparentTheme());d.addPlot("default",{type:N,enableCache:!0,markers:!0,gap:10,minBarSize:2,maxBarSize:60});d.addAxis("x",{type:!1===h.verticalAxis?v:u,vertical:!0,natural:!0,labels:m,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});d.addAxis("y",{type:!1===
h.horizontalAxis?v:u,includeZero:!0,natural:!0});h=this._getColors(h,1);d.addSeries("default",n,{stroke:{color:h[0]},fill:h[0]});new B(d,"default");new z(d,"default");new y(d,"default");d.render();this._bindFieldModeChartEvent(d);d.createSelf=this._getRecreateChartFunction(this._createFieldModeBarChart,a,b,c,e);return d},_createFieldModeLineChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),h=e.getConfig(),m=[],n=[];p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=
c[a],f=w.localizeNumber(e);m.push({value:b+1,text:d});n.push({y:e,tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+d+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+f+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));
d=new x(b);d.setTheme(this._createTransparentTheme());d.addPlot("default",{type:H,markers:!0,tension:"X"});var f=this._calculateHorizontalRotation(b,m);d.addAxis("x",{type:!1===h.horizontalAxis?v:u,natural:!0,includeZero:!0,labels:m,rotation:f,fontColor:this.fontColor,majorLabels:!0,minorLabels:!0,majorTickStep:1});d.addAxis("y",{type:!1===h.verticalAxis?v:u,vertical:!0,natural:!0});h=this._getColors(h,1);d.addSeries("default",n,{stroke:{color:h[0]},fill:h[0]});new J(d,"default");new z(d,"default");
new y(d,"default");d.render();this._bindFieldModeChartEvent(d);d.createSelf=this._getRecreateChartFunction(this._createFieldModeLineChart,a,b,c,e);return d},_createFieldModePieChart:function(a,b,c,e){var d=a.config.valueFields,q=this._getFieldAliasArray(d),h=e.getConfig(),m=r.getContentBox(b),m=Math.floor(Math.min(m.w,m.h)/2/this.pieScale)-3,n=[],f=[],l=0,k;for(k in c)l+=Math.abs(c[k]);p.forEach(d,g.hitch(this,function(a,b){var d=q[b],e=c[a],g=this._tryLocaleNumber((e/l*100).toFixed(1))+"%",h=w.localizeNumber(e);
n.push({value:b+1,text:d});f.push({text:d,y:Math.abs(e),tooltip:"\x3cdiv class\x3d'jimu-widget-chart-preview-tooltip'style\x3d'color:"+this.tooltipColor+";'\x3e\x3ctable style\x3d'border-collapse:separate; border-spacing:8px;'\x3e\x3ctbody\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+d+"\x3c/div\x3e\x3c/td\x3e\x3ctd\x3e:\x3c/td\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+h+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3cdiv style\x3d'white-space:nowrap'\x3e"+
g+"\x3c/div\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e"})}));k=new x(b);d=this._createPieTheme(h,d.length);d.plotarea.fill="transparent";d.chart.fill="transparent";k.setTheme(d);k.addPlot("default",{type:I,radius:m,labels:!!h.label});k.addSeries("default",f);new B(k,"default");new z(k,"default");new y(k,"default");k.render();this._bindFieldModeChartEvent(k);k.createSelf=this._getRecreateChartFunction(this._createFieldModePieChart,a,b,c,e);return k},_createTransparentTheme:function(){return new O({plotarea:{fill:"transparent"},
chart:{fill:"transparent"}})}})});