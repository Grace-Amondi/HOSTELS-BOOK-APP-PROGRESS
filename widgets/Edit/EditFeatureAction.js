// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred jimu/BaseFeatureAction jimu/portalUtils jimu/Role jimu/WidgetManager".split(" "),function(h,k,e,g,l,m,n,p){return h(l,{map:null,iconClass:"icon-edit",isFeatureSupported:function(a,c){var d=new g,b=new g;m.getPortal(window.portalUrl).getUser().then(e.hitch(this,function(a){b.resolve(a)}),e.hitch(this,function(){b.resolve(null)}));b.then(e.hitch(this,function(a){this._checkEditPrivilege(a)||d.resolve(!1);var b=c||e.getObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",
!1,this.map.infoWindow);if(b){var f=!1;a=this.appConfig.getConfigElementById(this.widgetId).config;a.editor.layerInfos?0===a.editor.layerInfos.length?f=!0:k.forEach(a.editor.layerInfos.concat(a.editor.tableInfos||[]),function(a){b.id===a.featureLayer.id&&(f=!0)}):f=!1;f&&b.isEditable&&b.isEditable()?d.resolve(!0):d.resolve(!1)}else d.resolve(!1)}));return d},onExecute:function(a,c){var d=c||e.getObject("_wabProperties.popupInfo.layerForActionWithEmptyFeatures",!1,this.map.infoWindow),b=new g;p.getInstance().triggerWidgetOpen(this.widgetId).then(function(b){b.beginEditingByFeatures(a.features,
d)});return b.promise},_checkEditPrivilege:function(a){var c=!0;a&&(c=new n({id:a.roleId?a.roleId:a.role,role:a.role}),a.privileges&&c.setPrivileges(a.privileges),c=c.canEditFeatures());return c}})});