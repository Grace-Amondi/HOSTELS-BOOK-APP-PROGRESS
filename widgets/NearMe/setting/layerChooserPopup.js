// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:widgets/NearMe/setting/layerChooserPopup.html":'\x3cdiv data-dojo-attach-point\x3d"layerSelectorContainer" style\x3d"width: 100%; height: 100%;"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"layerSelectorNode" class\x3d"esriCTLayerSelectorNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n'}});
define("dojo/_base/declare jimu/BaseWidgetSetting dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/text!./layerChooserPopup.html jimu/dijit/LayerChooserFromMap jimu/dijit/Popup dojo/dom-construct".split(" "),function(g,h,k,e,l,d,m,f){return g([h,k],{baseClass:"jimu-widget-nearme-setting",templateString:l,_layerChooserFromMap:null,popup:null,searchLayers:[],startup:function(){this.inherited(arguments)},postCreate:function(){this.searchLayers=[];this._initLayerSelector();this._createLayerSelectorPopup()},
_initLayerSelector:function(){var a={multiple:!0,createMapResponse:this.map.webMapResponse,showLayerTypes:["FeatureLayer"],filter:this._createFiltersForLayerSelector()};this._layerChooserFromMap=new d(a);this._layerChooserFromMap.placeAt(this.layerSelectorNode);this._layerChooserFromMap.startup();this._layerChooserFromMap._onTreeClick=e.hitch(this,function(){this._layerChooserFromMap.getSelectedItems().length?this.popup.enableButton(0):this.popup.disableButton(0)})},_createFiltersForLayerSelector:function(){var a,
b;a=d.createFeaturelayerFilter(["point","polyline","polygon"],!1,!1);b=d.createImageServiceLayerFilter(!0);return d.orCombineFilters([a,b])},_createLayerSelectorPopup:function(){this.okButton=f.create("button",{title:this.nls.common.ok});this.okButton.label=this.nls.common.ok;this.okButton.onClick=e.hitch(this,this._getSelectedSearchLayers);this.cancelButton=f.create("button",{title:this.nls.common.cancel});this.cancelButton.label=this.nls.common.cancel;this.popup=new m({titleLabel:this.nls.layerSelector.selectLayerLabel,
content:this.layerSelectorContainer,width:640,autoHeight:!0,buttons:[this.okButton,this.cancelButton]});this.popup.disableButton(0)},_getSelectedSearchLayers:function(){var a,b,d,c;this.searchLayers=[];b=this._layerChooserFromMap.getSelectedItems();if(0<b.length)for(a=0;a<b.length;a++)c={url:b[a].layerInfo.layerObject.url,geometryType:b[a].layerInfo.layerObject.geometryType,id:b[a].layerInfo.id},c.layerId=b[a].layerId?b[a].layerId:c.url.substr(c.url.lastIndexOf("/")+1,c.url.length),d=c.url.substr(0,
c.url.lastIndexOf("/")+1),c.baseURL=d,this.searchLayers.push(c);this.onOkClick()},onOkClick:function(a){return a}})});