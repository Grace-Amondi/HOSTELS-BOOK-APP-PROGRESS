// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/FilterParameters":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/promise/all dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter ./_filter/ValueProviderFactory".split(" "),function(g,t,k,m,r,p,e,n,d,l,b,c,u,f,h,x,y){return r([p,e,n,t],{baseClass:"jimu-filter-parameters",templateString:'\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e',
_filterUtils:null,_spObj:null,nls:null,partsObj:null,layerInfo:null,OPERATORS:null,url:null,featureLayerId:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this._filterUtils=new f;this.OPERATORS=d.clone(this._filterUtils.OPERATORS);this._spObj={}},destroy:function(){this.clear();this._filterUtils=null;this.inherited(arguments)},getFilterExpr:function(){var a=this._getNewValidPartsObj(this.partsObj,!0);return a?this._getFilterExprByPartsObj(a):null},getValueProviders:function(){for(var a=
[],c=this._getAllInteractiveSinglePartArray(this.partsObj),b=0;b<c.length;b++){var d=c[b].spId;d&&(d=this._getSingleFilterParameterBySpId(d),a.push(d))}return a},_getNewValidPartsObj:function(a,c){a=d.clone(a);for(var v={logicalOperator:a.logicalOperator,parts:[]},f=d.hitch(this,function(a){if(a.spId){var c=this._getSingleFilterParameterBySpId(a.spId);a.valueObj=c.getValueObject();return c.getStatus()}return a.valueObj?1:-1}),e=d.hitch(this,function(a){var c=f(a);0<c&&v.parts.push(a);return c}),h=
d.hitch(this,function(a){var c=[];a.parts=b.filter(a.parts,d.hitch(this,function(a){a=f(a);c.push(a);return 0<a}));1===a.parts.length?v.parts.push(a.parts[0]):2<=a.parts.length&&v.parts.push(a);return Math.min.apply(c,c)}),l=0;l<a.parts.length;l++){var u=a.parts[l];if(u.parts){if(0>h(u)&&c)return null}else if(0>e(u)&&c)return null}return v},_getFilterExprByPartsObj:function(a){this._filterUtils.isHosted=h.isHostedService(this.url);return this._filterUtils.getExprByFilterObj(a)},_getSingleFilterParameterBySpId:function(a){return this._spObj[a]},
_getCascadeFilterExpr:function(a){var c="1\x3d1",f={logicalOperator:this.partsObj.logicalOperator,parts:[]},e=d.clone(this.partsObj),h,l,u;h="none";a.interactiveObj&&a.interactiveObj.cascade&&(h=a.interactiveObj.cascade);if("previous"===h)for(h=0;h<e.parts.length;h++)l=e.parts[h],l.majorCascadeIndex<a.majorCascadeIndex?f.parts.push(l):l.parts&&l.majorCascadeIndex===a.majorCascadeIndex&&(u=d.clone(l),u.parts=b.filter(u.parts,d.hitch(this,function(c){return c.minorCascadeIndex<a.minorCascadeIndex})),
f.parts.push(u));else if("all"===h)for(h=0;h<e.parts.length;h++)l=e.parts[h],l.majorCascadeIndex!==a.majorCascadeIndex?f.parts.push(l):l.majorCascadeIndex===a.majorCascadeIndex&&l.parts&&(u=d.clone(l),b.some(l.parts,d.hitch(this,function(c){return c.spId===a.spId}))&&(u.parts=b.filter(u.parts,d.hitch(this,function(c){return c.minorCascadeIndex!==a.minorCascadeIndex})),f.parts.push(u)));(f=this._getNewValidPartsObj(f,!1))&&(c=this._getFilterExprByPartsObj(f));c||(c="1\x3d1");return c},clear:function(){this.featureLayerId=
this.url=null;var a=c(".jimu-widget-query-single-parameter",this.tbody);b.forEach(a,d.hitch(this,function(a){u.byNode(a).destroy()}));l.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(a,v,f,h){var e=new k;this.clear();this.url=a;this.layerInfo=v;this.partsObj=d.clone(f);this.partsObj=this._updatePartsObj(this.partsObj);this.featureLayerId=h;this._setCascadeIndexForPartsObj(this.partsObj);a=this._getAllInteractiveSinglePartArray(this.partsObj);if(0<a.length){var u=new y({url:this.url,
layerDefinition:v,featureLayerId:this.featureLayerId});a=b.map(a,d.hitch(this,function(a){var b=l.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),b=c("td",b)[0],f=this._getFieldInfo(a.fieldObj.name,this.layerInfo),f=new x({nls:this.nls,url:this.url,layerDefinition:v,fieldInfo:f,part:a,valueProviderFactory:u});this.own(g(f,"change",d.hitch(this,this._onSingleFilterParameterChanged)));f.placeAt(b);f.startup();a.spId=f.id;return this._spObj[f.id]=f}));b.forEach(a,d.hitch(this,function(a){a.valueProvider.getCascadeFilterExpr=
d.hitch(this,this._getCascadeFilterExpr,a.part)}));a=b.map(a,d.hitch(this,function(a){return a.init()}));m(a).then(d.hitch(this,function(){e.resolve()}),d.hitch(this,function(){e.reject()}))}else e.resolve();return e},_updatePartsObj:function(a){b.forEach(a,d.hitch(this,function(a){a.parts?b.forEach(a.parts,d.hitch(this,function(a){a.interactiveObj&&!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")})):a.interactiveObj&&
!0===a.interactiveObj.cascade?a.interactiveObj.cascade="previous":!1===a.interactiveObj.cascade&&(a.interactiveObj.cascade="none")}));return a},_setCascadeIndexForPartsObj:function(a){for(var c=0;c<a.parts.length;c++){var b=a.parts[c];b.majorCascadeIndex="AND"===a.logicalOperator?c:0;b.minorCascadeIndex=0;b.cascadeIndex=b.majorCascadeIndex;if(b.parts)for(var d=0;d<b.parts.length;d++){var f=b.parts[d];f.majorCascadeIndex=b.majorCascadeIndex;f.minorCascadeIndex="AND"===b.logicalOperator?d:0;f.cascadeIndex=
parseFloat(f.majorCascadeIndex+"."+f.minorCascadeIndex)}}},_getFieldInfo:function(a,c){for(var b=c.fields,d=0;d<b.length;d++){var f=b[d];if(a===f.name)return f}return null},_getAllInteractiveSinglePartArray:function(a){for(var c=[],b=0;b<a.parts.length;b++){var d=a.parts[b];if(d.parts)for(var f=0;f<d.parts.length;f++){var h=d.parts[f];h.interactiveObj&&c.push(h)}else d.interactiveObj&&c.push(d)}return c},_onSingleFilterParameterChanged:function(){this.emit("change",this.getFilterExpr(!1))}})})},"jimu/dijit/_SingleFilterParameter":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang".split(" "),
function(g,t,k,m,r,p,e,n,d){return m([r,p,e,t],{baseClass:"jimu-single-filter-parameter",templateString:n,valueProvider:null,nls:null,url:null,layerDefinition:null,fieldInfo:null,part:null,valueProviderFactory:null,postCreate:function(){this.inherited(arguments);this.valueProvider=this.valueProviderFactory.getValueProvider(this.part,!0);this.valueProvider.placeAt(this.valueProviderTd);this.own(g(this.valueProvider,"change",d.hitch(this,this._onValueProviderChanged)));this.valueProvider.bindChangeEvents()},
getValueObject:function(){return this.valueProvider.getValueObject()},init:function(){return this.build(this.fieldInfo,this.part)},build:function(d,b){var c=null;this.fieldInfo=d;this.part=b;if(c=b.interactiveObj)this.promptNode.innerHTML=c.prompt||"",this.hintNode.innerHTML=c.hint||"";c=this.valueProvider.setValueObject(this.part.valueObj);c&&"function"===typeof c.then||(c=new k,c.resolve());return c},disable:function(){this.valueProvider.disable()},enable:function(){this.valueProvider.enable()},
isEnabled:function(){return this.valueProvider.isEnabled()},getStatus:function(){return this.valueProvider.getStatus()},_showValidationErrorTip:function(d){!d.validate()&&d.domNode&&d.focusNode&&(d.focusNode.focus(),d.focusNode.blur())},_onValueProviderChanged:function(){this.emit("change")}})})},"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/declare ./BlankValueProvider ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider jimu/LayerInfos/LayerInfos".split(" "),
function(g,t,k,m,r,p,e,n,d){var l={stringOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",
supportAskForValue:!0,filterCodedValueIfPossible:!0}},stringOperatorStartsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorEndsWith:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorContains:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorDoesNotContain:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0,supportCaseSensitive:!0}},stringOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},stringOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIs:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",codedValueProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsNot:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtLeast:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsLessThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsAtMost:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsGreaterThan:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"},unique:{normalProviderType:"LIST_VALUE_PROVIDER",supportAskForValue:!0,filterCodedValueIfPossible:!0}},numberOperatorIsBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsNotBetween:{value:{normalProviderType:"TWO_NUMBERS_VALUE_PROVIDER",supportAskForValue:!0}},numberOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},numberOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},
dateOperatorIsOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBefore:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normalProviderType:"SIMPLE_VALUE_PROVIDER",
supportAskForValue:!0},field:{normalProviderType:"LIST_VALUE_PROVIDER"}},dateOperatorIsBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsNotBetween:{value:{normalProviderType:"TWO_DATES_VALUE_PROVIDER",supportAskForValue:!0}},dateOperatorIsBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}},dateOperatorIsNotBlank:{value:{normalProviderType:"BLANK_VALUE_PROVIDER"}}},b=k([],{nls:null,url:null,layerDefinition:null,layerInfo:null,featureLayerId:null,
constructor:function(c){g.mixin(this,c);this.nls=window.jimuNls.filterBuilder;c=d.getInstanceSync();this.featureLayerId&&(this.layerInfo=c.getLayerOrTableInfoById(this.featureLayerId))},getSupportedValueTypes:function(c,b){var d=[],h=l[b];h&&(h.value&&d.push("value"),h.field&&0<this._getSameShortTypeFieldNames(c).length&&d.push("field"),h.unique&&this.url&&(this._isStreamServer(this.url)||10.1<=parseFloat(this.layerDefinition.currentVersion)&&d.push("unique")));return d},_isStreamServer:function(c){c=
(c||"").replace(/\/*$/g,"");return/\/StreamServer$/gi.test(c)},_getSameShortTypeFieldNames:function(c){var d=[],f=this._getFieldInfo(this.layerDefinition,c),h=b.getShortTypeByEsriType(f.type);t.forEach(this.layerDefinition.fields,g.hitch(this,function(f){f.name!==c&&b.getShortTypeByEsriType(f.type)===h&&d.push(f.name)}));return d},getValueProvider:function(c,d){var b=null,h=g.clone(l[c.operator]);if(h){var u=c.valueObj.type,k=c.fieldObj.name,a=this._getFieldInfo(this.layerDefinition,k),v=h[u],A=v.normalProviderType,
B=null,C=this._getCodedValues(a);C||this.layerDefinition.typeIdField&&this.layerDefinition.typeIdField.toUpperCase()===k.toUpperCase()&&(C=this._getSubTypes(this.layerDefinition));"field"===u?(u=this._getSameShortTypeFieldNames(k),0<u.length&&(B=t.map(u,g.hitch(this,function(a){return{value:a,label:a}})))):C&&0<C.length&&v.codedValueProviderType&&(A=v.codedValueProviderType);h={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:c,fieldInfo:a,codedValues:C,staticValues:B,layerInfo:this.layerInfo,
operatorInfo:h,filterCodedValueIfPossible:!!v.filterCodedValueIfPossible,runtime:d};"BLANK_VALUE_PROVIDER"===A?b=new m(h):"SIMPLE_VALUE_PROVIDER"===A?b=new r(h):"TWO_NUMBERS_VALUE_PROVIDER"===A?b=new p(h):"TWO_DATES_VALUE_PROVIDER"===A?b=new e(h):"LIST_VALUE_PROVIDER"===A&&(h.showNullValues=!1,b=new n(h))}return b},_getFieldInfo:function(c,d){for(var b=c.fields,h=0;h<b.length;h++){var e=b[h];if(d===e.name)return e}return null},_getCodedValues:function(c){var b=null;(c=c.domain)&&"codedValue"===c.type&&
c.codedValues&&0<c.codedValues.length&&(b=c.codedValues,b=t.map(b,g.hitch(this,function(c){return{value:c.code,label:c.name}})));return b},_getSubTypes:function(c){var b=null;c.typeIdField&&c.types&&0<c.types.length&&(b=t.map(c.types,g.hitch(this,function(c){return{value:c.id,label:c.name}})));return b}});b.getOperatorInfo=function(c){return g.clone(l[c])};b.getOperatorsByShortType=function(c){var b=[];"string"===c?b="stringOperatorIs stringOperatorIsNot stringOperatorStartsWith stringOperatorEndsWith stringOperatorContains stringOperatorDoesNotContain stringOperatorIsBlank stringOperatorIsNotBlank".split(" "):
"number"===c?b="numberOperatorIs numberOperatorIsNot numberOperatorIsAtLeast numberOperatorIsLessThan numberOperatorIsAtMost numberOperatorIsGreaterThan numberOperatorIsBetween numberOperatorIsNotBetween numberOperatorIsBlank numberOperatorIsNotBlank".split(" "):"date"===c&&(b="dateOperatorIsOn dateOperatorIsNotOn dateOperatorIsBefore dateOperatorIsAfter dateOperatorIsBetween dateOperatorIsNotBetween dateOperatorIsBlank dateOperatorIsNotBlank".split(" "));return b};b.getShortTypeByEsriType=function(c){var b=
null;"esriFieldTypeString"===c?b="string":"esriFieldTypeDate"===c?b="date":0<=["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"].indexOf(c)&&(b="number");return b};return b})},"jimu/dijit/_filter/BlankValueProvider":function(){define(["dojo/_base/html","dojo/_base/declare","./ValueProvider"],function(g,t,k){return t([k],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,
"jimu-filter-blank-value-provider")},getDijits:function(){return[]},getStatus:function(){return 1},setValueObject:function(){},getValueObject:function(){return{isValid:!0,type:this.partObj.valueObj.type,value:null}},isBlankValueProvider:function(){return!0}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils esri/lang".split(" "),function(g,t,k,m,r,p,e,
n,d,l){return p([e,n,t],{baseClass:"jimu-filter-value-provider",fieldName:null,shortType:null,_enabled:!1,cascade:"none",filterCodedValue:!1,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,runtime:!0,staticValues:null,codedValues:null,layerInfo:null,operatorInfo:null,filterCodedValueIfPossible:!1,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;this.cascade=this.partObj.interactiveObj&&
this.partObj.interactiveObj.cascade;this.runtime&&this.codedValues&&this.filterCodedValueIfPossible&&d.isCodedValuesSupportFilter(this.layerDefinition,this.codedValues.length)?this.filterCodedValue=!0:this.filterCodedValue=!1},getDijits:function(){return[]},bindChangeEvents:function(){var b=this.getDijits();r.forEach(b,k.hitch(this,function(b){b.declaredClass&&0===b.declaredClass.indexOf("dijit.")&&m.addClass(b.domNode,b.declaredClass.replace(/\./g,"-"));this.own(g(b,"change",k.hitch(this,this._onChanged)))}))},
_onChanged:function(){this.emit("change")},tryLocaleNumber:function(b){var c=d.localizeNumber(b);if(null===c||void 0===c)c=b;return c},getPartObject:function(){var b=this.getValueObject();if(!b)return null;var c=k.clone(this.partObj);c.valueObj=b;return c},setValueObject:function(){},getValueObject:function(){},tryGetValueObject:function(){return this.getValueObject()},setRequired:function(){},getStatus:function(){var b=1,c=this.getDijits();0<c.length&&(b=r.map(c,k.hitch(this,function(b){return this.getStatusForDijit(b)})),
b=Math.min.apply(b,b));return b},getStatusForDijit:function(b){return b.validate()?b.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},isBlankValueProvider:function(){return!1},getFilterExpr:function(){var b="1\x3d1",b=this.getLayerFilterExpr();if("all"===this.cascade||"previous"===this.cascade)var c=this.getCascadeFilterExpr(),b="("+b+") AND ("+c+")";return b},
getLayerFilterExpr:function(){var b="1\x3d1";this.layerInfo&&(b=this.layerInfo.getFilter());b||(b="1\x3d1");return b},getCascadeFilterExpr:function(){return"1\x3d1"},isDefined:function(b){return l.isDefined(b)},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),
function(g,t,k,m,r,p){return t([k],{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-filter-simple-value-provider");this._dijit="string"===this.shortType?new m({required:!1,trim:!0}):"number"===this.shortType?new p({required:!1,intermediateChanges:!0,constraints:{pattern:"#####0.##########"}}):new r({required:!1,trim:!0,value:new Date});g.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},
getDijits:function(){return[this._dijit]},setValueObject:function(e){this.isDefined(e.value)&&("date"===this.shortType?this._dijit.set("value",new Date(e.value)):this._dijit.set("value",e.value))},getValueObject:function(){if(this.isValidValue()){var e=this._dijit.get("value");"date"===this.shortType?e=e.toDateString():"number"===this.shortType&&(e=parseFloat(e));return{isValid:!0,type:this.partObj.valueObj.type,value:e}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():
this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(e){this._dijit.set("required",e)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(g,t,k){return g("dijit.form.DateTextBox",k,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:t,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(g,t,k,m,r,p,e,n,d,l,b,c,u,f,h,x,y){var a=m("dijit.Calendar",[u,f,h],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){n.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new a._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:l.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(b(this.domNode,"keydown",l.hitch(this,"_onKeyDown")),b(this.dateRowsNode,"mouseover",l.hitch(this,"_onDayMouseOver")),b(this.dateRowsNode,"mouseout",l.hitch(this,"_onDayMouseOut")),b(this.dateRowsNode,"mousedown",l.hitch(this,"_onDayMouseDown")),b(this.dateRowsNode,"mouseup",l.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){(a=p.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!p.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode)&&(p.add(a,"dijitCalendarHoveredDate"),this._currentNode=a)},_onDayMouseOut:function(a){!this._currentNode||
a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode||(a="dijitCalendarHoveredDate",p.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),p.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&!p.contains(a,"dijitCalendarDisabledDate")&&(p.add(a,"dijitCalendarActiveDate"),this._currentNode=a)},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&p.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,c,f=this.currentFocus;switch(a.keyCode){case d.RIGHT_ARROW:b=1;case d.LEFT_ARROW:c="day";this.isLeftToRight()||(b*=-1);break;case d.DOWN_ARROW:b=1;case d.UP_ARROW:c="week";break;case d.PAGE_DOWN:b=1;case d.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case d.END:f=this.dateModule.add(f,"month",1),c="day";case d.HOME:f=new this.dateClassObj(f);f.setDate(1);break;default:return!0}c&&(f=this.dateModule.add(f,c,b));this._setCurrentFocusAttr(f);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});a._MonthDropDownButton=m("dijit.Calendar._MonthDropDownButton",y,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new a._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});a._MonthDropDown=m("dijit.Calendar._MonthDropDown",[f,x,h],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";g.forEach(a,function(a,b){e.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(r.get(a.target,"month"))},onChange:function(){}});return a})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/dom-attr dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(g,t,k,m,r,p,e,n,d,l,b,c,u,f,h,x){var y=t("dijit.CalendarLite",[f,h],{templateString:x,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=p.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){if(a||
0===a)a=new this.dateClassObj(a),a.setHours(1,0,0,0);return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),f=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),h=new this.dateClassObj,e=0<=this.dayOffset?this.dayOffset:k.getFirstDayOfWeek(this.lang);e>
b&&(e-=7);if(!this.summary){var l=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",l[a.getMonth()])}this._date2cell={};g.forEach(this.dateCells,function(l,n){var u=n+e,k=new this.dateClassObj(a),g="dijitCalendar",m=0;u<b?(u=f-b+u+1,m=-1,g+="Previous"):u>=b+c?(u=u-b-c+1,m=1,g+="Next"):(u=u-b+1,g+="Current");m&&(k=this.dateModule.add(k,"month",m));k.setDate(u);this.dateModule.compare(k,h,"date")||(g="dijitCalendarCurrentDate "+g);this.isDisabledDate(k,
this.lang)?(g="dijitCalendarDisabledDate "+g,l.setAttribute("aria-disabled","true")):(g="dijitCalendarEnabledDate "+g,l.removeAttribute("aria-disabled"),l.setAttribute("aria-selected","false"));(m=this.getClassForDate(k,this.lang))&&(g=m+" "+g);l.className=g+"Month dijitCalendarDateTemplate";g=k.valueOf();this._date2cell[g]=l;l.dijitDateValue=g;g=k.getDateLocalized?k.getDateLocalized(this.lang):k.getDate();this._setText(this.dateLabels[n],g);d.set(l,"aria-label",r.format(k,{selector:"date",formatLength:"long"}))},
this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;g.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?l.getObject(a.datePackage,
!1):m;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?l.getObject(a.datePackage+".locale",!1):r},_createMonthWidget:function(){return y._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,b=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),c=0<=this.dayOffset?this.dayOffset:k.getFirstDayOfWeek(this.lang);this.dayCellsHtml=u.substitute([a,
a,a,a,a,a,a].join(""),{d:""},function(){return b[c++%7]});a=u.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);e.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=l.hitch(this,function(a,
c,d){this[a].dojoClick=!0;return b(this[a],"click",l.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,c,d))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var d=this.currentFocus,f=this._getNodeByDate(d);a=this._patchDate(a);this._set("currentFocus",a);this._date2cell&&0==this.dateModule.difference(d,a,"month")||(this._populateGrid(),
this._populateControls(),this._markSelectedDates([this.value]));d=this._getNodeByDate(a);d.setAttribute("tabIndex",this.tabIndex);(this.focused||b)&&d.focus();f&&f!=d&&(c("webkit")?f.setAttribute("tabIndex","-1"):f.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue&&0!==a.dijitDateValue;a=a.parentNode);a&&!n.contains(a,"dijitCalendarDisabledDate")&&this.set("value",
a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,b){n.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}g.forEach(this._selectedCells||[],l.partial(b,!1));this._selectedCells=g.filter(g.map(a,this._getNodeByDate,this),function(a){return a});g.forEach(this._selectedCells,l.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});
y._MonthWidget=t("dijit.CalendarLite._MonthWidget",f,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),d=6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+g.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=d+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return y})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(g,t,k,m,r,p,e,n){new Date("X");return m("dijit.form._DateTimeTextBox",[p,e],{templateString:n,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:t.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(d,e){var b=this._isInvalidDate(d),c=this._isInvalidDate(e);if(b||c)return b&&c?0:b?-1:1;var b=this.format(d,this._unboundedConstraints),c=this.format(e,this._unboundedConstraints),
l=this.parse(b,this._unboundedConstraints),f=this.parse(c,this._unboundedConstraints);return b==c?0:g.compare(l,f,this._selector)},autoWidth:!0,format:function(d,e){return d?this.dateLocaleModule.format(d,e):""},parse:function(d,e){return this.dateLocaleModule.parse(d,e)||(this._isEmpty(d)?null:void 0)},serialize:function(d,e){d.toGregorian&&(d=d.toGregorian());return k.toISOString(d,e)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(d){d=
d||{};this.dateModule=d.datePackage?r.getObject(d.datePackage,!1):g;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=d.datePackage?r.getObject(d.datePackage+".locale",!1):t;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(d){d.selector=this._selector;d.fullYear=!0;var e=k.fromISOString;"string"==typeof d.min&&(d.min=e(d.min),this.dateClassObj instanceof Date||(d.min=new this.dateClassObj(d.min)));"string"==typeof d.max&&(d.max=e(d.max),this.dateClassObj instanceof Date||(d.max=new this.dateClassObj(d.max)));this.inherited(arguments);this._unboundedConstraints=r.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(d){return!d||
isNaN(d)||"object"!=typeof d||d.toString()==this._invalidDate},_setValueAttr:function(d,e,b){void 0!==d&&("string"==typeof d&&(d=k.fromISOString(d)),this._isInvalidDate(d)&&(d=null),d instanceof Date&&!(this.dateClassObj instanceof Date)&&(d=new this.dateClassObj(d)));this.inherited(arguments,[d,e,b]);this.value instanceof Date&&(this.filterString="");!1!==e&&this.dropDown&&this.dropDown.set("value",d,!1)},_set:function(d,e){if("value"==d){e instanceof Date&&!(this.dateClassObj instanceof Date)&&
(e=new this.dateClassObj(e));var b=this._get("value");if(b instanceof this.dateClassObj&&0==this.compare(e,b))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(d){this._isInvalidDate(d)&&(d=new this.dateClassObj);this._set("dropDownDefaultValue",d)},openDropDown:function(d){this.dropDown&&this.dropDown.destroy();var e=r.isString(this.popupClass)?r.getObject(this.popupClass,!1):this.popupClass,b=this,c=this.get("value");this.dropDown=new e({onChange:function(c){b.set("value",
c,!0)},id:this.id+"_popup",dir:b.dir,lang:b.lang,value:c,textDir:b.textDir,currentFocus:this._isInvalidDate(c)?this.dropDownDefaultValue:c,constraints:b.constraints,filterString:b.filterString,datePackage:b.datePackage,isDisabledDate:function(c){return!b.rangeCheck(c,b.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(d,e){this._setValueAttr(this.parse(d,this.constraints),e,d)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox".split(" "),
function(g,t,k,m,r,p){return t([k,m,r],{templateString:p,postCreate:function(){this.inherited(arguments);g.addClass(this.domNode,"jimu-two-numbers-filter-value-provider")},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var e=parseFloat(this._dijit1.get("value")),n=parseFloat(this._dijit2.get("value"));e>n&&(this._dijit1.set("value",n),this._dijit2.set("value",e))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(e){this.isDefined(e.value1)&&
this._dijit1.set("value",e.value1);this.isDefined(e.value2)&&this._dijit2.set("value",e.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null},tryGetValueObject:function(){if(this.isValidValue())return this.getValueObject();if(this.isEmptyValue()){var e={isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))};
isNaN(e.value1)&&(e.value1=null);isNaN(e.value2)&&(e.value2=null);return e}return null},setRequired:function(e){this._dijit1.set("required",e);this._dijit2.set("required",e)}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoDatesValueProvider.html dijit/form/DateTextBox".split(" "),function(g,t,k,m,r,p){return t([k,m,r],{templateString:p,postCreate:function(){this.inherited(arguments);
g.addClass(this.domNode,"jimu-two-dates-filter-value-provider")},_onRangeDateBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var e=this._dijit1.get("value"),n=e.getTime(),d=this._dijit2.get("value"),l=d.getTime();n>l&&(this._dijit1.set("value",d),this._dijit2.set("value",e))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(e){this.isDefined(e.value1)&&this._dijit1.set("value",new Date(e.value1));this.isDefined(e.value2)&&this._dijit2.set("value",
new Date(e.value2))},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:this._dijit1.get("value").toDateString(),value2:this._dijit2.get("value").toDateString()}:null},setRequired:function(e){this._dijit1.set("required",e);this._dijit2.set("required",e)}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListValueProvider.html dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),
function(g,t,k,m,r,p,e,n,d,l,b,c){return p([e,n,d],{templateString:l,codedValues:null,staticValues:null,showNullValues:!1,postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-filter-list-value-provider");this._uniqueValueCache={};var c=new b({idProperty:"id",data:[]});this.valuesSelect.set("store",c);this.staticValues||"function"!==typeof this.valuesSelect._onDropDownMouseDown||(!this.codedValues||this.codedValues&&this.filterCodedValue)&&this.own(g.before(this.valuesSelect,
"_onDropDownMouseDown",k.hitch(this,this._onBeforeDropDownMouseDown)))},_onFilteringSelectInput:function(){this.emit("change")},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,!0);return arguments},getDijits:function(){return[this.valuesSelect]},setValueObject:function(b){return this.staticValues?this._setValueForStaticValues(b.value,this.staticValues):this.codedValues?this.filterCodedValue?this._tryUpdatingUniqueValues(b.value,!1):this._setValueForStaticValues(b.value,
this.codedValues):this._tryUpdatingUniqueValues(b.value,!1)},getValueObject:function(){if(this.isValidValue()){var b=this.valuesSelect.get("item").value;return{isValid:!0,type:this.partObj.valueObj.type,value:b}}return null},tryGetValueObject:function(){return this.isValidValue()?this.getValueObject():this.isEmptyValue()?{isValid:!0,type:this.partObj.valueObj.type,value:"string"===this.shortType?"":null}:null},setRequired:function(b){this.valuesSelect.set("required",b)},_setValueForStaticValues:function(b,
c){var d=null,e=-1,d=null;c&&(d=r.map(c,k.hitch(this,function(c,a){var d={id:a,value:c.value,label:c.label};d.value===b&&(e=a);return d})),this.valuesSelect.store.setData(d),0<=e&&(d=this.valuesSelect.store.get(e))&&this.valuesSelect.set("item",d))},_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(b,c){var d=new t;if(this.valuesSelect._opened)d.resolve();else{var e=this.getFilterExpr();e!==this._uniqueValueLoadingExpr?(this.valuesSelect.readOnly=
!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=e,this._uniqueValueLoadingDef=this._getUniqueValues(e),this._uniqueValueLoadingDef.then(k.hitch(this,function(e){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(b,e),this._hideLoadingIcon(),c&&this.valuesSelect.toggleDropDown(),d.resolve())}),k.hitch(this,function(b){console.error(b);this.domNode&&(this._uniqueValueLoadingDef=
null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),d.reject(b))}))):d.resolve()}return d},_setValueForUniqueValues:function(b,c){c.sort(function(a,b){return a.value<b.value?-1:a.value===b.value?0:1});this.showNullValues||(c=r.filter(c,k.hitch(this,function(a){return"\x3cNull\x3e"!==a.value&&null!==a.value})));if(void 0===b){var d=this.getValueObject();d&&(b=d.value)}var e=-1,d=null,f=r.map(c,k.hitch(this,function(a,c){var d={id:c,value:a.value,label:a.label};a.value===b&&(e=c);return d}));
this.valuesSelect.store.setData(f);0<=e&&(d=this.valuesSelect.store.get(e));this.valuesSelect.set("item",d)},_showLoadingIcon:function(){m.addClass(this.valuesSelect.domNode,"loading")},_hideLoadingIcon:function(){m.removeClass(this.valuesSelect.domNode,"loading")},_getUniqueValues:function(b){var d=new t;this._uniqueValueCache[b]?d.resolve(this._uniqueValueCache[b]):(this._showLoadingIcon(),c.getUniqueValues(this.url,this.fieldName,b,this.layerDefinition).then(k.hitch(this,function(c){this.domNode&&
(this._uniqueValueCache[b]=c,d.resolve(c),this._hideLoadingIcon())}),k.hitch(this,function(b){this.domNode&&(d.reject(b),this._hideLoadingIcon())})));return d}})})},"widgets/GroupFilter/SaveJSON":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/html dojo/has jimu/utils".split(" "),function(g,t,k,m,r,p){return t([g],{declaredClass:"saveJSON",config:null,constructor:function(e){t.safeMixin(this,e)},_getDownloadUrl:function(e){return window.Blob&&window.URL&&window.URL.createObjectURL?
(e=new Blob([e],{type:"text/json"}),URL.createObjectURL(e)):"data:attachment/json;charset\x3dutf-8,"+encodeURIComponent(e)},exportsJson:function(e,n){var d=JSON.stringify(n),l=new k;try{if(r("ie")&&10>r("ie")){var b=window.top.open("about:blank","_blank");b.document.write("sep\x3d,\r\n"+d);b.document.close();b.document.execCommand("SaveAs",!0,e);b.close();this.savePrompt()}else if(10===r("ie")||this._isIE11()||this._isEdge()){var c=new Blob([d],{type:"text/json"});navigator.msSaveBlob(c,e);this.savePrompt()}else{var g=
m.create("a",{href:this._getDownloadUrl(d),target:"_blank",download:e},document.body);if(r("safari")){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0);g.dispatchEvent(f)}else g.click();this.savePrompt();m.destroy(g)}l.resolve()}catch(h){l.reject(h)}return l},_isIE11:function(){return 11===p.has("ie")},_isEdge:function(){return p.has("edge")},savePrompt:function(){this.emit("complete",{})}})})},"widgets/GroupFilter/ReadJSON":function(){define("dojo/Evented dojo/_base/declare dojo/has dojo/_base/lang jimu/utils jimu/dijit/Message".split(" "),
function(g,t,k,m,r,p){return t([g],{declaredClass:"readJSON",config:null,jsonFile:null,constructor:function(e){t.safeMixin(this,e)},checkFileReader:function(){this.supportHTML5()?(console.log("HTML 5 loader"),this._processFiles(this.jsonFile)):this.supportHTML5()||k("safari")||!this.isEnabledFlash()?console.log("no loader"):r.file.loadFileAPI().then(m.hitch(this,function(){console.log("loading FileAPI")}))},_processFiles:function(e){0<e.length&&(e=e[0],-1!==e.name.indexOf(".json")?e&&this.handleJson(e):
new p({message:"Not a json file"}))},handleJson:function(e){if(this.supportHTML5()){var n=new FileReader;n.onload=function(d){return function(){-1<n.result.indexOf("groups")?d.completePrompt(n.result):(new p({message:"json file is Invalid"}),d.errorPrompt("error"))}}(this);n.readAsText(e)}else window.FileAPI.readAsText(e,m.hitch(this,function(d){}))},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return k("safari")&&6>k("safari")?
!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var e=null;if(document.all)try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(n){e=null}else navigator.plugins&&0<navigator.plugins.length&&(e=navigator.plugins["Shockwave Flash"]);return!!e},completePrompt:function(e){this.emit("complete",{UserSettings:e})},errorPrompt:function(){this.emit("error",{UserSettings:"error"})}})})},"widgets/GroupFilter/LayersHandler":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/request".split(" "),
function(g,t,k,m,r,p,e){return t([g],{declaredClass:"LayersHandler",layers:null,layerStore:[],fieldName:null,childList:null,validFieldTypes:"esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeDouble esriFieldTypeSingle esriFieldTypeString esriFieldTypeDate esriFieldTypeGeometry esriFieldTypeOID esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeXML".split(" "),layersOnly:!1,constructor:function(e){t.safeMixin(this,e)},getAllMapLayers:function(){var e=
[],d=new r,l;this.layerStore=[];m.forEach(this.layers,k.hitch(this,function(b){if(!b.featureCollection)if("undefined"===typeof b.originOperLayer||!b.originOperLayer.layerType||"ArcGISFeatureLayer"!==b.originOperLayer.layerType&&"ArcGISImageServiceLayer"!==b.originOperLayer.layerType)if(0<b.newSubLayers.length){if(this.childList=[],"undefined"===typeof b.originOperLayer.layerType||"ArcGISTiledMapServiceLayer"!==b.originOperLayer.layerType)m.forEach(b.layerObject.layerInfos,k.hitch(this,function(c){c=
{label:c.name,id:b.id+"."+c.id,url:b.originOperLayer.url+"/"+c.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:b.layerObject};this.childList.push(c);e.push(this._getLayerInfo(c))})),l={label:b.title,id:b.id,url:b.originOperLayer.url,type:"Service",checked:!1,children:this.childList,layer:b.layerObject},this.layerStore.push(l)}else"ArcGISMapServiceLayer"===b.originOperLayer.layerType&&(this.childList=[],m.forEach(b.layerObject.layerInfos,k.hitch(this,function(c){c={label:c.name,
id:b.id+"."+c.id,url:b.originOperLayer.url+"/"+c.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:b.layerObject};this.childList.push(c);e.push(this._getLayerInfo(c))})),l={label:b.title,id:b.id,url:b.originOperLayer.url,type:"MapService",checked:!1,children:this.childList,layer:b.layerObject},this.layerStore.push(l));else"undefined"===typeof b.originOperLayer.featureCollection&&(l={label:b.title,id:b.id,url:b.url,fieldName:this.fieldName,type:"Feature Layer",checked:!1,children:[],
layer:b.layerObject},e.push(this._getLayerInfo(l)),this.layerStore.push(l))}));p(e).then(k.hitch(this,function(){var b=this._controlComplete();this.emit("complete",b);d.resolve(b)}),k.hitch(this,function(){d.resolve(null)}));return d.promise},_getLayerInfo:function(g){var d=new r;g.url?0===g.url.length?d.resolve():e({url:g.url,content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,function(e){if(e.hasOwnProperty("fields")&&!1===this.layersOnly){var b=m.map(e.fields,k.hitch(this,function(b){return{label:b.alias,
id:g.id+"."+b.name,name:b.name,type:"Field",fieldType:b.type,checked:!1}})),b=m.filter(b,k.hitch(this,function(b){return 0<=m.indexOf(this.validFieldTypes,b.fieldType)}));g.children=b}g.geometryType=e.geometryType;g.visible=!0;this.geometryTypes&&!m.some(this.geometryTypes,function(b){if(b===g.geometryType)return!0})&&(g.visible=!1);d.resolve(e)}),function(){d.resolve(null)}):d.resolve();return d.promise},_controlComplete:function(){m.forEach(this.layerStore,function(e){if(e.children&&0<e.children.length){var d=
m.filter(e.children,function(d){return d.hasOwnProperty("visible")?d.visible:!0});e.children=d;0===e.children.length&&(e.visible=!1)}});return this.store={data:{identifier:"id",label:"label",items:m.filter(this.layerStore,function(e){return e.hasOwnProperty("visible")?e.visible:!0})}}}})})},"widgets/GroupFilter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_SingleFilterParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr class\x3d"first-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"second-tr"\x3e\r\n        \x3ctd data-dojo-attach-point\x3d"valueProviderTd"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"third-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/ListValueProvider.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"valuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;" data-dojo-attach-event\x3d"input:_onFilteringSelectInput"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/GroupFilter/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"groupContainer" data-dojo-attach-point\x3d"widgetIntro"\x3e\r\n\t\t\x3cdiv class\x3d"group-picker"\x3e\r\n\t\t\t\x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"groupHeader"\x3e${nls.labels.selectGroup}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"saveTD" data-dojo-attach-point\x3d"optionsIcon" id\x3d"saveTD" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\x3cdiv data-dojo-attach-point\x3d"groupPicker" id\x3d"groupPicker"\x3e\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" id\x3d"groupDesc" data-dojo-attach-point\x3d"groupDesc"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"container" data-dojo-attach-point\x3d"filterBlock" id\x3d"filterBlock"\x3e\r\n\t\t\x3cdiv class\x3d"filter-block" data-dojo-attach-point\x3d"filterBlockInner" id\x3d"filterBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblPredicates" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"saveContainer" data-dojo-attach-point\x3d"saveBlock" id\x3d"saveBlock"\x3e\r\n\t\t\x3cdiv class\x3d"save-block" data-dojo-attach-point\x3d"saveBlockInner" id\x3d"saveBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdFirstLabel"\x3e${nls.labels.saveHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"close-save" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cdiv class\x3d"jimu-btn saveFunction" data-dojo-attach-event\x3d"click:saveJsonToFile" \x3e${nls.buttons.save}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.uploadHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"file" id\x3d"jsonFileInput" data-dojo-attach-point\x3d"jsonFileInput" data-dojo-attach-event\x3d"change:readJsonToConfig" accept\x3d".json"\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"loadProgressHeader" id\x3d"tdProgress"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\x3cbr\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.layerOptionHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr style\x3d"height:0px; display:none;"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkAppendToDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.AppendDefHeading}\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"slAppendChoice" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"OR"\x3e${nls.inputs.optionOR}\x3c/option\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"AND"\x3e${nls.inputs.optionAND}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkPersistDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.PersistDefHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\r\n\t\x3cdiv class\x3d"buttonContainer"\x3e\r\n\t\t\x3ctable class\x3d"buttonContainerTable" border\x3d0\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"filter-add-criteria"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnCriteria" data-dojo-attach-event\x3d"click:btnNewRowAction"\x3e${nls.buttons.addCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3ctable class\x3d"buttonContainerSubtable" border\x3d0\x3e\r\n\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-apply"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"click:setFilterLayerDef"\x3e${nls.buttons.applyCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-cancel"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnReset" data-dojo-attach-event\x3d"click:resetLayerDef"\x3e${nls.buttons.removeCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/css/style.css":'.jimu-widget-map-filter {width:100%; height:100%;}.jimu-widget-map-filter .groupContainer {display: block;}.jimu-widget-map-filter .container {border-color: #e1e1e1; border-top: 3px solid; width: 100%; height: 60%; position:relative; overflow-y: auto; overflow-x: auto; display: block;}.jimu-widget-map-filter .saveContainer {width: 100%; height: 100%; position:absolute; top: 0px; left: 0px; z-index: 999; overflow-y: auto; overflow-x: auto; display: none;}.jimu-widget-map-filter .save-block {position: absolute; left: 5px;}.jimu-widget-map-filter .close-save {position:relative; float: right; content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .close-save:after {position:relative; float: right; content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .headerTable {width: 100%;}.jimu-widget-map-filter .groupHeader {font-size: 10pt; padding-left: 0px; padding-bottom: 5px; width: 100%;}.jimu-widget-map-filter .saveTD {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTD:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose:after {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .group-picker {padding-bottom: 5px;}.jimu-widget-map-filter .filter-block {position: absolute; left: 0px; top: 5px;}.jimu-widget-map-filter .filter-row {position: relative; width: 100%;}.jimu-widget-map-filter .tableFormat {table-layout: fixed; width:100%;}.jimu-widget-map-filter .rowHeader {color: #000000;}.jimu-widget-map-filter .saveFunction {margin-top: 5px;}.jimu-widget-map-filter .tableRow {background-color: #E3E3E3;}.jimu-widget-map-filter .tdOperatorHide {display: block; width: 75px;}.jimu-widget-map-filter .operatorSelect {}.jimu-widget-map-filter .tdValue {width: 200px; height: 20px; padding-left: 5px;}.jimu-widget-map-filter .userInputNormal {width: 95%;}.jimu-widget-map-filter .tdConjunction {width: 75px;}.jimu-widget-map-filter .conjuncSelect {width: 70px;}.jimu-widget-map-filter .tdRemove {width: 16px; text-align: right;}.jimu-widget-map-filter .tdFirstLabel {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdLabel {text-align: left; padding-left: 5px; padding-top: 15px; padding-bottom: 2px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdData {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 5px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdUploadData {text-align: left; padding-left: 5px; padding-top: 10px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdSave {text-align: right; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .loadProgressHeader {display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow:after {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .advModeOffset {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeOffset:after {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeClose {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeClose:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeOpen {content: url(""); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .deleteCell {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:after {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:hover {content: url("../images/delete_hover.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .buttonContainer {position: absolute; left: 0px; bottom: 0px; width: 100%;}.jimu-widget-map-filter .buttonContainerTable {width: 100%;}.jimu-widget-map-filter .buttonContainerSubtable {float: right;}.jimu-widget-map-filter .filter-add-criteria {text-align: left;}.jimu-widget-map-filter .filter-button-apply {text-align: right; padding-right: 5px;}.jimu-widget-map-filter .filter-button-cancel {text-align: right;}.jimu-widget-map-filter .criteriaCellSize {width: 90%; vertical-align: top; padding-top: 5px; padding-left: 2px;}.jimu-widget-map-filter .deleteCellSize {width: 20px; text-align: right; vertical-align: top; padding-top: 5px;}.jimu-widget-map-filter .hide-items {display: none;}.jimu-widget-map-filter .operator-class {}.jimu-widget-map-filter .value-class {}',
"*now":function(g){g(['dojo/i18n!*preload*widgets/GroupFilter/nls/Widget*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit jimu/dijit/FilterParameters dojo/dom dojo/dom-construct dojo/dom-class dojo/dom-attr dojo/dom-style dojo/on dojo/query dojo/string dojo/_base/lang dojo/_base/array dojo/date/locale dijit/form/Select dijit/form/TextBox dijit/form/DateTextBox dijit/form/NumberTextBox dijit/registry jimu/LayerInfos/LayerInfos jimu/utils jimu/FilterManager esri/tasks/query esri/tasks/QueryTask esri/geometry/geometryEngine esri/layers/FeatureLayer ./SaveJSON ./ReadJSON ./LayersHandler dojox/html/entities dijit/form/CheckBox".split(" "),function(g,
t,k,m,r,p,e,n,d,l,b,c,u,f,h,x,y,a,v,A,B,C,w,I,F,E,D,H,J,K,L,G){return g([k,t],{baseClass:"jimu-widget-map-filter",layerList:null,msLayersDesc:null,grpSelect:null,groupCounter:0,groupCurrVal:null,defaultDef:null,runTimeConfig:null,useDomain:null,useDate:null,useValue:null,runInitial:!1,graphicsHolder:null,slAppendChoice:null,chkAppendToDef:null,filterExt:null,dayInMS:86399E3,postCreate:function(){this.inherited(arguments);this.defaultDef=[];this.graphicsHolder=[]},startup:function(){this.inherited(arguments);
this.config.optionsMode&&n.add(this.optionsIcon,"hide-items");""!==this.config.groups[0].defaultVal&&""!==this.config.groups[0].operator&&(this.runInitial=!0);"undefined"!==typeof this.config.webmapAppendMode&&(this.chkAppendToDef.checked=this.config.webmapAppendMode,this.slAppendChoice.value=this.config.slAppendChoice);this.createMapLayerList()},btnNewRowAction:function(){var a=this.checkDefaultValue(this.config.groups[0]),b=this.checkDefaultOperator(this.config.groups[0]);this.createNewRow({operator:b,
value:a,conjunc:"OR",state:"new"})},createMapLayerList:function(){C.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(a){a._layerInfos&&0<a._layerInfos.length&&(this.layerList=a._layerInfos,this._pullMapServiceFields(a._layerInfos),h.forEach(this.layerList,f.hitch(this,function(a){"ArcGISTiledMapServiceLayer"!==a.originOperLayer.layerType&&"undefined"===typeof a.originOperLayer.featureCollection&&("undefined"!==typeof a.layerObject._defnExpr?this.defaultDef.push({layer:a.id,definition:a.layerObject._defnExpr,
visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.defaultDefinitionExpression&&"function"===typeof a.layerObject.getDefinitionExpression()?this.defaultDef.push({layer:a.id,definition:a.layerObject.getDefinitionExpression(),visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.layerDefinitions?this.defaultDef.push({layer:a.id,definition:a.layerObject.layerDefinitions,visible:a._visible}):this.defaultDef.push({layer:a.id,definition:"",visible:a.layerObject.visible}))})))}))},
_pullMapServiceFields:function(a){this.msLayersDesc=[];a=new L({layers:a});this.own(b(a,"complete",f.hitch(this,function(a){h.forEach(a.data.items,f.hitch(this,function(a){0<a.children.length&&this.msLayersDesc.push(a)}));this.createGroupSelection()})));this.own(b(a,"error",f.hitch(this,function(){console.log("error")})));a.getAllMapLayers()},checkDomainUse:function(a){this.useValue=this.useDomain=null;h.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&h.forEach(b.layers,f.hitch(this,
function(a){h.forEach(this.layerList,f.hitch(this,function(b){"undefined"!==typeof b.newSubLayers&&(0<b.newSubLayers.length?h.forEach(this.msLayersDesc,f.hitch(this,function(b){h.forEach(b.children,f.hitch(this,function(b){b.id===a.layer&&h.forEach(b.children,f.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain)}))}))})):a.layer===b.id&&h.forEach(b.layerObject.fields,f.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain,"undefined"!==
typeof b.domain&&(this.useDomain=b.domain))})))}))}))}))},checkDateUse:function(a){this.useDate=null;h.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&h.forEach(b.layers,f.hitch(this,function(a){h.forEach(this.layerList,f.hitch(this,function(b){a.layer===b.id&&h.forEach(b.layerObject.fields,f.hitch(this,function(b){b.name===a.field&&0<=b.type.indexOf("Date")&&(this.useDate=!0)}))}))}))}))},createGroupSelection:function(){var a=[],c="";h.forEach(this.config.groups,f.hitch(this,
function(b){var c={};c.value=b.name;c.label=b.name;c.selected=!1;a.push(c)}));this.grpSelect=(new y({options:a})).placeAt(this.groupPicker);this.grpSelect.startup();this.own(b(this.grpSelect,"change",f.hitch(this,function(a){this.resetLayerDef({group:this.groupCurrVal});this.removeAllRows();this.checkDomainUse({group:a});this.checkDateUse({group:a});this.reconstructRows(a);this.updateGroupDesc(a);this.groupCurrVal=a;setTimeout(f.hitch(this,this.setFilterLayerDef),1E3)})));this.checkDomainUse({group:this.grpSelect.value});
this.checkDateUse({group:this.grpSelect.value});this.groupCurrVal=this.grpSelect.value;"undefined"!==typeof this.config.groups[0]&&(c=this.config.groups[0].desc,this.groupDesc.innerHTML=c);var c=this.checkDefaultValue(this.config.groups[0]),d=this.checkDefaultOperator(this.config.groups[0]);this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"})},createNewRow:function(a){var b=p.byId("tblPredicates"),d;"new"===a.state&&(1<b.rows.length?(d=b.rows[b.rows.length-1].cells[0].firstChild,d=d.rows[2].cells[0],
this.createConditionSelection(d,a)):1===b.rows.length&&(d=b.rows[b.rows.length-1].cells[0].firstChild,d=d.rows[2].cells[0],this.createConditionSelection(d,a)));d=b.insertRow(-1);var q=d.insertCell(0),h=d.insertCell(1);n.add(q,"criteriaCellSize");n.add(h,"deleteCellSize");var g=e.create("table",{border:"0",width:"100%"},q),q=g.insertRow(-1),k=q.insertCell(0),m=g.insertRow(-1).insertCell(0),g=g.insertRow(-1).insertCell(0);l.set(g,{paddingLeft:"3px",paddingRight:"3px"});n.add(q,"operator-class");this.colorRows();
this.createOperatorSelection(k,a);this.removeTableRow(h,d,b.rows.length);this.createInputFilter(m,a);this.resize();this.config.simpleMode&&(n.add(this.btnCriteria,"hide-items"),n.add(q,"hide-items"),c(".container").style("borderTop","0px"),l.set(m,{paddingLeft:"0px",paddingRight:"0px"}));"reload"===a.state?""!==a.conjunc&&(d=b.rows[b.rows.length-1].cells[0].firstChild,d=d.rows[2].cells[0],this.createConditionSelection(d,a)):this.runInitial&&(this.runInitial=!1,setTimeout(f.hitch(this,this.setFilterLayerDef),
1E3))},colorRows:function(){var a=p.byId("tblPredicates").rows;h.forEach(a,function(a,b){0===b%2?n.remove(a,"tableRow"):n.add(a,"tableRow")})},createOperatorSelection:function(a,d){var c=(new y({options:[{value:"\x3d",label:this.nls.inputs.optionEQUAL},{value:"\x3c\x3e",label:this.nls.inputs.optionNOTEQUAL},{value:"\x3e",label:this.nls.inputs.optionGREATERTHAN},{value:"\x3e\x3d",label:this.nls.inputs.optionGREATERTHANEQUAL},{value:"\x3c",label:this.nls.inputs.optionLESSTHAN},{value:"\x3c\x3d",label:this.nls.inputs.optionLESSTHANEQUAL},
{value:"START",label:this.nls.inputs.optionSTART},{value:"END",label:this.nls.inputs.optionEND},{value:"LIKE",label:this.nls.inputs.optionLIKE},{value:"NOT LIKE",label:this.nls.inputs.optionNOTLIKE},{value:"d\x3c\x3d",label:this.nls.inputs.optionONORBEFORE},{value:"d\x3e\x3d",label:this.nls.inputs.optionONORAFTER}],"class":"operatorSelect"})).placeAt(a);c.startup();c.set("value",G.decode(d.operator));this.own(b(c,"click",f.hitch(this,function(){})));this.own(b(c,"change",f.hitch(this,function(){})))},
createInputFilter:function(b,d){e.empty(b);if(null!==this.useDomain)if("undefined"!==typeof this.useDomain.codedValues){var c=new r;c.placeAt(b);c.startup();this.createValueList(d,c)}else c="",""!==d.value&&(c=Number(d.value)),(new A({value:c,placeHolder:u.substitute(this.nls.inputs.textboxNumber,{0:this.useDomain.minValue,1:this.useDomain.maxValue}),"class":"userInputNormal",constraints:{min:this.useDomain.minValue,max:this.useDomain.maxValue}})).placeAt(b).startup(),this.formatSpacing(b);else if(!0===
this.useValue)c=new r,c.placeAt(b),c.startup(),this.createValueList(d,c);else{if(!0===this.useDate){var c=x.format(""!==d.value?new Date(d.value):new Date,{selector:"date",fullYear:!0}),f=(new v({value:c,placeHolder:c,"class":"userInputNormal"})).placeAt(b);f.startup();f.set("displayedValue",c)}else(new a({value:d.value,placeHolder:this.nls.inputs.textboxText,"class":"userInputNormal"})).placeAt(b).startup();this.formatSpacing(b)}},createValueList:function(a,c){var d={},e=[],q="";h.forEach(this.config.groups,
f.hitch(this,function(z){z.name===this.grpSelect.value&&h.forEach(z.layers,f.hitch(this,function(z){q="";h.forEach(this.layerList,f.hitch(this,function(g){0<g.newSubLayers.length?h.forEach(this.msLayersDesc,f.hitch(this,function(g){h.forEach(g.children,f.hitch(this,function(h){if(h.id===z.layer){if(q!==h.id&&!0===z.useDomain){var g=new H(h.url);this.own(b(g,"load",f.hitch(this,function(){this._callFilterDijit(z,a,h.url,g,e,d,c)})))}q=h.id}}))})):z.layer===g.id&&!0===z.useDomain&&this._callFilterDijit(z,
a,g.layerObject.url,g.layerObject,e,d,c)}))}))}))},_callFilterDijit:function(a,b,e,g,k,l,m){var q={fieldObj:{}};q.fieldObj.name=a.field;q.fieldObj.label=a.field;q.fieldObj.shortType=a.dataType.replace("esriFieldType","").toLowerCase();if("guid"!==q.fieldObj.shortType||"globalid"!==q.fieldObj.shortType)q.fieldObj.shortType="string";"date"!==q.fieldObj.shortType&&"string"!==q.fieldObj.shortType&&(q.fieldObj.shortType="number");q.fieldObj.type=a.dataType;q.operator=q.fieldObj.shortType+"OperatorIs";
q.valueObj={};q.valueObj.isValid=!0;q.valueObj.type="unique";-1<a.dataType.indexOf("Integer")||-1<a.dataType.indexOf("Double")||-1<a.dataType.indexOf("Short")?q.valueObj.value=this.useDomain?Number(b.value):b.value:q.valueObj.value=b.value;q.interactiveObj={};q.interactiveObj.prompt="";q.interactiveObj.hint="";q.caseSensitive=!1;k.push(q);l.logicalOperator="OR";l.expr="";l.parts=k;m.build(e,g,l).then(f.hitch(this,function(){}));a=c(".jimu-single-filter-parameter");h.forEach(a,function(a){var b=c("table",
a);h.forEach(b,function(a){d.set(a,"cellpadding","1");d.set(a,"cellspacing","1")});a=c("colgroup",a);0<a.length&&d.set(a[0].childNodes[1],"width","0px")})},formatSpacing:function(a){l.set(a,{paddingLeft:"2px",paddingRight:"2px"})},createConditionSelection:function(a,b){e.empty(a);var c=(new y({options:[{value:"OR",label:this.nls.inputs.optionOR},{value:"AND",label:this.nls.inputs.optionAND}],"class":"conjuncSelect"})).placeAt(a);c.startup();c.set("value",b.conjunc)},removeTableRow:function(a,c,d){1<
d&&(d=e.create("div",{"class":"deleteCell",innerHTML:""}),this.own(b(d,"click",f.hitch(this,function(){e.destroy(c);var a=p.byId("tblPredicates");1<=a.rows.length&&e.empty(a.rows[a.rows.length-1].cells[0].firstChild.rows[2].cells[0]);this.colorRows()}))),e.place(d,a))},removeAllRows:function(){var a=p.byId("tblPredicates");if(1<=a.rows.length){var b=B.byNode(a.rows[0].cells[0].firstChild.rows[1].cells[0].childNodes[0]);"undefined"!==typeof b&&m.byId(b.id).destroyRecursive(!0);e.destroy(a.rows[0]);
this.removeAllRows()}},reconstructRows:function(a){""!==a?h.forEach(this.config.groups,f.hitch(this,function(b){if(b.name===a){var c="",d="\x3d";"undefined"!==typeof b.def?0<b.def.length?h.forEach(b.def,f.hitch(this,function(a){this.createNewRow({value:a.value,operator:a.operator,conjunc:a.conjunc,state:"reload"})})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),
this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"}))}})):this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},checkDefaultValue:function(a){var b="";""!==a.defaultVal&&(b=a.defaultVal);return b},checkDefaultOperator:function(a){var b="\x3d";""!==a.operator&&(b=a.operator);return b},parseTable:function(){var a=[],b=p.byId("tblPredicates").rows;h.forEach(b,f.hitch(this,function(b,d){if(0<=d){var e=b.cells[0].firstChild,f=B.byNode(e.rows[0].cells[0].childNodes[0]),q=B.byNode(e.rows[1].cells[0].childNodes[0]),
h={};"undefined"!==typeof e.rows[2].cells[0].childNodes[0]?h=B.byNode(e.rows[2].cells[0].childNodes[0]):h.value="";var g="";if("undefined"!==typeof q.partsObj){if(q=q.getValueProviders()[0].getValueObject())g=q.value}else g=q.value;e=c(".dijitReset.dijitInputInner",e.rows[1].cells[0].childNodes[0]);0<e.length&&""===e[0].value&&(g="");a.push({operator:f.value,userValue:g,conjunc:h.value})}}));return a},formatDate:function(a){var b=x.format(a,{datePattern:"yyyy-MM-dd",selector:"date"});a=x.format(a,
{selector:"time",timePattern:"HH:mm:ss"});return b+" "+a},addDay:function(a){return new Date(a.getTime()+this.dayInMS)},subtractDay:function(a){return new Date(a.getTime()-this.dayInMS)},createQuery:function(a,b,c,d,e,f){isNaN(d)&&(d=G.decode(d.replace(/'/g,"''")));if(""===d)return"\x3c\x3e"===c||"NOT LIKE"===c?-1<f.indexOf("Double")||-1<f.indexOf("Single")?[b,"IS NOT NULL",e].join(" ")+" ":[b,"\x3c\x3e '' OR",b,"IS NOT NULL",e].join(" ")+" ":-1<f.indexOf("Double")||-1<f.indexOf("Single")?[b,"IS NULL",
e].join(" ")+" ":[b,"\x3d '' OR",b,"IS NULL",e].join(" ")+" ";if("LIKE"===c||"NOT LIKE"===c)!1===a?(d="UPPER('%"+d+"%')",b="UPPER("+b+")"):d="'%"+d+"%'";else if("START"===c)c="LIKE",!1===a?(d="UPPER('"+d+"%')",b="UPPER("+b+")"):d+="%";else if("END"===c)c="LIKE",!1===a?(d="UPPER('%"+d+"')",b="UPPER("+b+")"):d="%"+d;else if(!1===a)if(-1<f.indexOf("Date"))if("\x3d"===c||"\x3c\x3e"===c)c="\x3d"===c?"BETWEEN":"NOT BETWEEN",d="'"+this.formatDate(d)+"' AND '"+this.formatDate(this.addDay(d))+"'";else if("\x3e"===
c)d="'"+this.formatDate(this.addDay(d))+"'";else{if("d\x3c\x3d"===c||"d\x3e\x3d"===c)c=c.substr(1);"\x3c\x3d"===c&&(d=this.addDay(d));d="'"+this.formatDate(d)+"'"}else d="UPPER('"+d+"')",b="UPPER("+b+")";return[b,c,d,e].join(" ")+" "},setFilterLayerDef:function(){this.filterExt=null;this.graphicsHolder=[];var a=this.parseTable();h.forEach(this.config.groups,f.hitch(this,function(b){if(this.grpSelect.value===b.name){var d=[];h.forEach(this.layerList,f.hitch(this,function(c){var e=[],g="",q="",l="";
h.forEach(b.layers,f.hitch(this,function(k,m){"undefined"!==typeof b.appendSameLayer&&!0===b.appendSameLayer?q!==k.layer?""!==g&&(this.setupFilterToApply(c,l,g,e),g=""):""!==q&&(g=g+" "+b.appendSameLayerConjunc+" ",g===" "+b.appendSameLayerConjunc+" "&&(g="")):g="";if(c.id===k.layer)b.def=[],l="FeatureLayer",h.forEach(a,f.hitch(this,function(a){h.forEach(c.layerObject.fields,f.hitch(this,function(c){if(c.name===k.field){if(-1<c.type.indexOf("Integer")||-1<c.type.indexOf("Double")||-1<c.type.indexOf("Single")){var e=
w.sanitizeHTML(a.userValue);if(!1===isNaN(e)){if(0!==w.sanitizeHTML(a.userValue)%1){var f=e.split(".");6<f[1].length&&(f[1]=f[1].substring(0,6),e=f[0]+"."+f[1]);"\x3d"===a.operator?a.operator="LIKE":"\x3c\x3e"===a.operator&&(a.operator="NOT LIKE")}g+=this.createQuery(!0,k.field,a.operator,e,a.conjunc,c.type)}else console.log("Not a Number")}else-1<c.type.indexOf("Date")?""!==a.userValue?(e=new Date(w.sanitizeHTML(a.userValue)),-1<c.type.indexOf("Time")?x.format(e,{fullYear:!0,datePattern:"yyyy-MM-dd, HH:mm:ss a"}):
x.format(e,{fullYear:!0,datePattern:"yyyy-MM-dd"}),g+=this.createQuery(!1,k.field,a.operator,e,a.conjunc,c.type)):g+=this.createQuery(!1,k.field,a.operator,w.sanitizeHTML(a.userValue),a.conjunc,c.type):g+=this.createQuery(!1,k.field,a.operator,w.sanitizeHTML(a.userValue),a.conjunc,c.type);b.def.push({field:k.field,value:w.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc});d.push({field:k.field,value:w.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc})}}))}));else if(0<=
k.layer.indexOf(c.id)){b.def=[];l="MapService";var z=k.layer.split(".");h.forEach(a,f.hitch(this,function(a){if(""!==a.userValue)if(-1<k.dataType.indexOf("Integer")||-1<k.dataType.indexOf("Double"))g+=this.createQuery(!0,k.field,a.operator,w.sanitizeHTML(a.userValue),a.conjunc,k.dataType);else if(-1<k.dataType.indexOf("Date"))if(""!==a.userValue){var c=new Date(w.sanitizeHTML(a.userValue)),c=-1<k.dataType.indexOf("Time")?x.format(c,{fullYear:!0,datePattern:"yyyy-MM-dd, HH:mm:ss a"}):x.format(c,{fullYear:!0,
datePattern:"yyyy-MM-dd"});g+=this.createQuery(!1,k.field,a.operator,c,a.conjunc,k.dataType)}else g+=this.createQuery(!1,k.field,a.operator,w.sanitizeHTML(a.userValue),a.conjunc,k.dataType);else g+=this.createQuery(!1,k.field,a.operator,w.sanitizeHTML(a.userValue),a.conjunc,k.dataType);else g+=this.createQuery(!1,k.field,a.operator,w.sanitizeHTML(a.userValue),a.conjunc,k.dataType);b.def.push({field:k.field,value:w.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc});d.push({field:k.field,
value:w.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc})}));""!==g&&(e[z[1]]=g.trim())}q=k.layer;"undefined"!==typeof b.appendSameLayer&&!1===b.appendSameLayer?this.setupFilterToApply(c,l,g,e):m===b.layers.length-1&&this.setupFilterToApply(c,l,g,e)}))}));"undefined"!==typeof d&&0<d.length&&this._publishData(d)}}))},setupFilterToApply:function(a,b,c,d){"FeatureLayer"===b?""!==c&&(this._applyFilter(a.layerObject,c.trim()),a.layerObject.setVisibility(!0)):"MapService"===b&&0<d.length&&
(this.chkAppendToDef.checked?h.forEach(this.defaultDef,f.hitch(this,function(b){b.layer===a.id&&(h.forEach(d,f.hitch(this,function(a,c){for(var e in b.definition)"undefined"!==b.definition[e]&&d[c.toString()]&&(d[c.toString()]="("+b.definition[e]+") "+this.slAppendChoice.value+" "+a)})),a.layerObject.setLayerDefinitions(d),this._zoomOnFilter(a.layerObject))})):(a.layerObject.setLayerDefinitions(d),this._zoomOnFilter(a.layerObject)),a.layerObject.setVisibility(!0))},resetLayerDef:function(a){"undefined"===
typeof a.group&&(a.group=this.grpSelect.value);h.forEach(this.config.groups,f.hitch(this,function(b){b.name===a.group&&h.forEach(b.layers,f.hitch(this,function(a){h.forEach(this.layerList,f.hitch(this,function(b){var c=!1;a.layer===b.id?c=!0:0<b.newSubLayers.length&&h.forEach(b.newSubLayers,f.hitch(this,function(d){d=b.id+"."+d.id.substring(d.id.lastIndexOf("_")+1);a.layer===d&&(c=!0)}));c&&h.forEach(this.defaultDef,f.hitch(this,function(a){a.layer===b.id&&("undefined"!==typeof b.layerObject.defaultDefinitionExpression?
this._applyFilter(b.layerObject,a.definition):"undefined"!==typeof b.layerObject.layerDefinitions?b.layerObject.setLayerDefinitions(a.definition):this._applyFilter(b.layerObject,a.definition),b.layerObject.setVisibility(a.visible))}))}))}))}))},updateGroupDesc:function(a){h.forEach(this.config.groups,f.hitch(this,function(b){b.name===a&&(this.groupDesc.innerHTML=b.desc)}))},toggleSaveFilter:function(){var a;0<c(".saveTD").length?(a=c(".container"),0<a.length&&(n.replace(p.byId("saveTD"),"saveTDClose",
"saveTD"),a.style("display","none"),c(".saveContainer").style("display","block"),c(".groupContainer").style("display","none"),c(".buttonContainer").style("display","none"))):(a=c(".saveTDClose"),0<a.length&&(n.replace(a[0],"saveTD","saveTDClose"),a=c(".container"),0<a.length&&(n.replace(p.byId("saveTD"),"saveTD","saveTDClose"),a.style("display","block"),c(".saveContainer").style("display","none"),c(".groupContainer").style("display","block"),c(".buttonContainer").style("display","block"))))},saveJsonToFile:function(){var a=
new J({config:this.config});this.own(b(a,"complete",f.hitch(this,function(){console.log("save done")})));a.exportsJson(this.nls.files.jsonFile+".json",this.config)},readJsonToConfig:function(){c(".loadProgressHeader").style("display","block");c(".loadProgressShow").style("display","block");var a=new K({config:this.config,jsonFile:this.jsonFileInput.files});this.own(b(a,"complete",f.hitch(this,function(a){this.config=JSON.parse(a.UserSettings);this.resetLayerDef({group:this.grpSelect.value});this.removeAllRows();
this.checkDomainUse({group:this.grpSelect.value});this.checkDateUse({group:this.grpSelect.value});this.reconstructRows(this.grpSelect.value);this.updateGroupDesc(this.grpSelect.value);setTimeout(f.hitch(this,this.setFilterLayerDef),1E3);c(".loadProgressHeader").style("display","none");c(".loadProgressShow").style("display","none");this.jsonFileInput.value=null;this.toggleSaveFilter()})));this.own(b(a,"error",f.hitch(this,function(){this.jsonFileInput.value=null;c(".loadProgressHeader").style("display",
"none");c(".loadProgressShow").style("display","none")})));a.checkFileReader();return!0},_publishData:function(a){var b=[],c=[];h.forEach(a,f.hitch(this,function(a){-1===b.indexOf(a.field)&&b.push(a.field);-1===c.indexOf(a.value)&&c.push(a.value)}));this.publishData({message:{fields:b,values:c}})},resize:function(){var a=c(".jimu-single-filter-parameter");0<a.length&&h.forEach(a,f.hitch(this,function(a){a=c("colgroup",a);0<a.length&&d.set(a[0].childNodes[1],"width","0px")}));320>=window.innerWidth?
(n.add(this.btnCriteria,"hide-items"),c(".operator-class").style("display","none"),c(".container").style("borderTop","0px"),c(".value-class").style("paddingTop","-10px")):this.config.simpleMode||(n.remove(this.btnCriteria,"hide-items"),c(".operator-class").style("display","block"),c(".container").style("borderTop","3px solid"),c(".value-class").style("paddingTop","0px"))},_applyFilter:function(a,b){var c=!1;"AND"===this.slAppendChoice.value&&(c=!0);I.getInstance().applyWidgetFilter(a.id,this.id,b,
this.chkAppendToDef.checked,c);this._zoomOnFilter(a)},_zoomOnFilter:function(a){if(this.config.zoomMode)if("undefined"!==typeof a.layerDefinitions&&0<a.layerDefinitions.length)var c=b(this.map,"update-end",f.hitch(this,function(){var b=new F;b.outFields=["*"];for(var d in a.layerDefinitions)if(a.layerDefinitions.hasOwnProperty(d)){var e=a.url+"/"+d;b.where=a.layerDefinitions[d];b.returnGeometry=!0;b.outSpatialReference=this.map.spatialReference;(new E(e)).executeForExtent(b,f.hitch(this,this._queryExtentToZoom))}c.remove()}));
else{var d=new F;d.outFields=["*"];if("ArcGISImageServiceLayer"===a.type){var e=a.url;d.where=a.getDefinitionExpression();d.returnGeometry=!0;d.outSpatialReference=this.map.spatialReference;(new E(e)).executeForExtent(d,f.hitch(this,this._queryExtentToZoom))}else a.queryExtent(d,f.hitch(this,this._queryExtentToZoom))}},_queryExtentToZoom:function(a){if("undefined"!==typeof a.extent&&null!==a.extent){var b;b=102100!==a.extent.spatialReference.wkid&&102113!==a.extent.spatialReference.wkid&&3857!==a.extent.spatialReference.wkid&&
4326!==a.extent.spatialReference.wkid?D.buffer(a.extent,10,9002,!1).getExtent():D.geodesicBuffer(a.extent,10,9002,!1).getExtent();null===this.filterExt&&(this.filterExt=b);b=b.update(this.filterExt.xmin<b.xmin?this.filterExt.xmin:b.xmin,this.filterExt.ymin<b.ymin?this.filterExt.ymin:b.ymin,this.filterExt.xmax>b.xmax?this.filterExt.xmax:b.xmax,this.filterExt.ymax>b.ymax?this.filterExt.ymax:b.ymax,b.spatialReference);this.filterExt=b=102100!==a.extent.spatialReference.wkid&&102113!==a.extent.spatialReference.wkid&&
3857!==a.extent.spatialReference.wkid&&4326!==a.extent.spatialReference.wkid?D.buffer(b,200,9002,!1).getExtent():D.geodesicBuffer(b,200,9002,!1).getExtent();this.map.setExtent(b)}},onOpen:function(){console.log("onOpen")},onClose:function(){this.chkPersistDef.checked||(this.resetLayerDef({group:this.grpSelect.value}),this.removeAllRows(),this.reconstructRows(this.grpSelect.value))},onMinimize:function(){console.log("onMinimize")},onMaximize:function(){console.log("onMaximize")},onSignIn:function(a){console.log("onSignIn")},
onSignOut:function(){console.log("onSignOut")}})});