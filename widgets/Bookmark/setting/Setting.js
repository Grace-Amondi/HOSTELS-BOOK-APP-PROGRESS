// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Bookmark/setting/Edit":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting esri/geometry/Extent jimu/dijit/ImageChooser jimu/dijit/ExtentChooser jimu/utils dojo/text!./Edit.html".split(" "),function(m,h,g,k,f,n,p,d,q,r,l){return m([n,f],{baseClass:"jimu-Bookmark-Edit",ImageChooser:null,templateString:l,extent:{},portalUrl:null,itemId:null,isInWebmap:!1,mapOptions:null,postCreate:function(){this.inherited(arguments);
this.imageChooser=new d({cropImage:!0,defaultSelfSrc:this.folderUrl+"images/thumbnail_default.png",showSelfImg:!0,format:[d.GIF,d.JPEG,d.PNG],goldenWidth:100,goldenHeight:60});this.own(k(this.displayName,"Change",h.hitch(this,"_onNameChange")));g.addClass(this.imageChooser.domNode,"img-chooser");g.place(this.imageChooser.domNode,this.imageChooserBase,"replace")},setConfig:function(b){var e={portalUrl:this.portalUrl,itemId:this.itemId};b.displayName&&this.displayName.set("value",b.displayName);if(b.thumbnail){var d=
r.processUrlInWidgetConfig(b.thumbnail,this.folderUrl);this.imageChooser.setDefaultSelfSrc(d)}b.extent&&(e.initExtent=new p(b.extent));this.mapOptions&&this.mapOptions.lods&&(e.lods=this.mapOptions.lods);b.isInWebmap&&(this.isInWebmap=!0);this.extentChooser=new q(e,this.extentChooserNode);this.own(k(this.extentChooser,"extentChange",h.hitch(this,this._onExtentChange)))},getConfig:function(){return{displayName:this.displayName.get("value"),name:this.displayName.get("value"),extent:this.extentChooser.getExtent(),
thumbnail:this.imageChooser.imageData,isInWebmap:this.isInWebmap}},_onNameChange:function(){this._checkRequiredField()},_onExtentChange:function(b){this.currentExtent=b},_checkRequiredField:function(){this.displayName.get("value")?this.popup&&this.popup.enableButton(0):this.popup&&this.popup.disableButton(0)}})})},"jimu/dijit/ExtentChooser":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Deferred dijit/_WidgetBase dojo/Evented esri/geometry/Extent jimu/portalUrlUtils jimu/dijit/LoadingShelter jimu/utils".split(" "),
function(m,h,g,k,f,n,p,d,q,r,l){return m([n,p],{baseClass:"jimu-extent-chooser",declaredClass:"jimu.dijit.ExtentChooser",portalUrl:null,itemId:null,initExtent:null,bingMapsKey:"",geometryServiceURL:null,shelter:null,postCreate:function(){this.inherited(arguments);!this.geometryServiceURL&&esriConfig.defaults.geometryService&&(this.geometryServiceURL=esriConfig.defaults.geometryService.url);this.geometryServiceURL||(this.geometryServiceURL=l.getServices().geometryService);this.shelter=new r({hidden:!0});
this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();var b=g.create("div",{style:{width:"100%",height:"100%"}},this.domNode);if(this.portalUrl&&this.itemId){this.portalUrl=q.getStandardPortalUrl(this.portalUrl);var e={geometryServiceURL:this.geometryServiceURL,bingMapsKey:this.bingMapsKey};this.initExtent&&("esri.geometry.Extent"!==this.initExtent.declaredClass&&(this.initExtent=new d(this.initExtent)),e.mapOptions={extent:this.initExtent});this.lods&&("object"===typeof e.mapOptions?
e.mapOptions.lods=this.lods:e.mapOptions={lods:this.lods});l.createWebMap(this.portalUrl,this.itemId,b,e).then(h.hitch(this,function(b){this.map=b.map;this.map.webMapResponse=b;this.own(k(this.map,"extent-change",h.hitch(this,function(a){this.onExtentChange(a.extent)})));if(this.initExtent)this.onExtentChange(this.initExtent);else this.onExtentChange(this.map.extent);this.shelter.hide();this.emit("map-load",this.map)}),h.hitch(this,function(b){console.error(b)}))}},getExtent:function(){return this.map&&
this.map.extent},setExtent:function(b){if(this.map)return this.map.setExtent(b);var d=new f;setTimeout(h.hitch(this,function(){d.reject("map is null.")}),0);return d},restoreToDefaultWebMapExtent:function(){l.restoreToDefaultWebMapExtent(this.map,this.map.webMapResponse,this.geometryServiceURL)},onExtentChange:function(b){this.emit("extent-change",b)}})})},"widgets/Bookmark/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],
function(){})},"url:widgets/Bookmark/setting/Edit.html":'\x3cdiv style\x3d"width: 100%"\x3e\r\n  \x3ctable class\x3d"setting-table input-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd title\x3d"${nls.title}" class\x3d"first"\x3e*${nls.title}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"displayName"\r\n            required\x3d"true" placeHolder\x3d${nls.title} data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd title\x3d"${nls.thumbnail}" class\x3d"first"\x3e${nls.thumbnail}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"imageChooserBase"\x3e\x3c/div\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;(${nls.thumbnailHint})\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e                                                                  \r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e \r\n    \x3cdiv class\x3d"extent-chooser" style\x3d"height: 400px" data-dojo-attach-point\x3d"extentChooserNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Bookmark/setting/Setting.html":'\x3cdiv\x3e\r\n    \x3cdiv class\x3d"marks-table-div" data-dojo-attach-point\x3d"bookmarksDiv"\x3e\r\n     \x3cdiv class\x3d\'bookmark-add jimu-float-leading jimu-leading-margin2\' data-dojo-attach-event\x3d"onclick: onAddBookmarkClick"\x3e\r\n      \x3cdiv class\x3d"add_mark_image"\x3e\x3c/div\x3e\u200b\r\n      \x3cdiv title\x3d"${nls.add}" class\x3d"add_mark_text"\x3e${nls.add}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n \x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/Bookmark/setting/css/style.css":".jimu-img-node{font-size: 12px; position: relative; float: left; color: #686868; overflow: hidden;}.jimu-img-node .node-box{border-radius: 4px; overflow: hidden;}.jimu-img-node img{width: 100%; height: 100%; cursor: pointer;}.jimu-img-node .node-label{height: 30px; text-align: center; overflow: hidden; text-overflow: ellipsis;}.jimu-img-node:hover{color: #51b1fe;}.jimu-img-node.jimu-state-selected .node-label{background-color: #d9dde0;}.jimu-widget-bookmark-setting {height: 100%;}.jimu-widget-bookmark-setting .bookmark-list{height: 100%; width: 100%; overflow: auto;}.jimu-widget-bookmark-setting .marks-table-div{width: 100%; height: 100%; overflow-x:hidden; overflow-y:auto;}.jimu-widget-bookmark-setting .bookmark-add{position:relative; width:100px; height:60px; padding:3px; text-align:center; color:#999999; font-size:10px; border:1px dotted gray; -webkit-border-radius:5px; -moz-border-radius:5px; -o-border-radius:5px; -ms-border-radius:5px; border-radius:5px; background-size:cover; margin-top: 5px; margin-left: 20px\\9;}.jimu-widget-bookmark-setting .bookmark-add .add_mark_image{display: block; position: absolute; left: 43px; top: 5px; width:14px; height:14px; background-position:center center; background-image:url(images/add_mark.png);}.jimu-widget-bookmark-setting .bookmark-add .add_mark_text{display: block; position: absolute; top: 25px; width: 100%; font-size: 12px; white-space: normal; height: 35px; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-bookmark-setting .bookmark-add:hover{cursor: pointer;}.jimu-widget-bookmark-setting .mark-item-div{position:relative; width:100px; height: 90px; font-size: 10px; margin-top: 5px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg{position:relative; width:100%; height:60px; line-height:28px; text-align:center; color:#999999; font-size:13px;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-thumbnail{width:100%; height:100%;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-detail-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg.selected .mark-item-thumbnail{-webkit-box-sizing:content-box; -moz-box-sizing:content-box; -ms-box-sizing:content-box; -o-box-sizing:content-box; box-sizing:content-box;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{display: none; position:absolute; right:2px; bottom:2px; width:20px; height:20px; background-color:rgba(0, 0, 0, 0.3); background-repeat:no-repeat; background-position:center center; background-image:url(images/edit_mark.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon:hover{background-color:rgba(0, 0, 0, 0.6);}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-detail-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{display: none; position:absolute; right:5px; top:5px; width:10px; height:10px; background-repeat:no-repeat; background-position:center center; background-image:url(images/delete_mark.png); -webkit-border-radius:3px; -moz-border-radius:3px; -o-border-radius:3px; -ms-border-radius:3px; border-radius:3px; cursor:pointer;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-bg:hover .mark-item-delete-icon{display: block;}.jimu-widget-bookmark-setting .mark-item-div .mark-item-title-wapper{width:100%; text-align:center; color:#333333; font-size:12px; margin-bottom: 25px; overflow: hidden; height: 2.7em; line-height: 16px; padding: 0 5px; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical;}.jimu-Bookmark-Edit{height: 100%; overflow-y: auto;}.jimu-Bookmark-Edit .setting-table {margin: 5px 20px; border-spacing: 10px; border-collapse: separate;}.jimu-Bookmark-Edit .setting-table .img-chooser{width: 100px; height: 60px;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .first{width:auto; text-align: left; padding-right:15px; white-space: nowrap; max-width: 108px; overflow: hidden; text-overflow: ellipsis;}.jimu-Bookmark-Edit .input-table \x3e tbody \x3e tr \x3e .second{width:660px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-delete-icon{right:auto; left: 5px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div .mark-item-bg .mark-item-detail-icon{right:auto; left: 2px;}.jimu-rtl .jimu-widget-bookmark-setting .mark-item-div:nth-child(8n+1){margin-left: auto; margin-right: 0px;}.jimu-rtl .jimu-widget-bookmark-setting .bookmark-add{margin-left: auto; margin-right: 20px\\9;}",
"*now":function(m){m(['dojo/i18n!*preload*widgets/Bookmark/setting/nls/Setting*["ar","bs","cs","da","de","en","el","es","et","fi","fr","he","hi","hr","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/keys dojo/query jimu/BaseWidgetSetting jimu/dijit/Popup jimu/dijit/Message jimu/utils ./Edit libs/storejs/store".split(" "),function(m,h,g,k,f,n,p,d,q,r,l,b,e,u){return m([q,h],{baseClass:"jimu-widget-bookmark-setting",bookmarks:[],edit:null,popup:null,popupState:"",editIndex:null,startup:function(){this.inherited(arguments);this.setConfig(this.config)},setConfig:function(a){this.config=
a;this.bookmarks=this.config.bookmarks2D;0===this.bookmarks.length&&this.map.itemInfo&&this.map.itemInfo.itemData&&this.map.itemInfo.itemData.bookmarks&&k.forEach(this.map.itemInfo.itemData.bookmarks,function(a){a.isInWebmap=!0;this.bookmarks.push(a)},this);this.currentBookmark=null;this.displayBookmarks()},getConfig:function(a){this.config.bookmarks2D=this.bookmarks;if(a){a=this._getKeysKey();for(var c in u.getAll())c.startWith(a)&&u.remove(c)}return this.config},displayBookmarks:function(){this._processDuplicateName(this.bookmarks);
this._clearBookmarksDiv();this._createmarkItems()},_clearBookmarksDiv:function(){for(var a=d(".mark-item-div",this.domNode),c=0;c<a.length;c++)f.destroy(a[c])},destroy:function(){this.inherited(arguments)},_getKeysKey:function(){return this.appConfig.map["3D"]?this.name+".3D":this.name+".2D"},onAddBookmarkClick:function(){this.popupState="ADD";this._openEdit(this.nls.addBookmark,{name:"",thumbnail:"",extent:this.map.extent.toJson()})},getBookmarkByName:function(a){for(var c=this.bookmarks.length,
b=0;b<c;b++)if(this.bookmarks[b].displayName===a)return this.editIndex=b,this.bookmarks[b]},_onEditClick:function(a){this.getBookmarkByName(a);a=this.bookmarks[this.editIndex];this.popupState="EDIT";this._openEdit(this.nls.edit,a)},_openEdit:function(a,c){this.edit=new e({nls:this.nls,folderUrl:this.folderUrl,portalUrl:this.appConfig.map.portalUrl,itemId:this.appConfig.map.itemId,mapOptions:this.appConfig.map.mapOptions});this.edit.setConfig(c||{});this.popup=new r({titleLabel:a,autoHeight:!0,content:this.edit,
container:"main-page",width:640,buttons:[{label:this.nls.ok,key:p.ENTER,disable:!0,onClick:g.hitch(this,"_onEditOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"],key:p.ESCAPE}],onClose:g.hitch(this,"_onEditClose")});f.addClass(this.popup.domNode,"widget-setting-popup");this.edit.startup()},_onEditOk:function(){var a=this.edit.getConfig(),c=null;a.name&&a.extent?("ADD"===this.popupState?(this.bookmarks.push(a),this.displayBookmarks(),c=!0):"EDIT"===this.popupState&&(this.bookmarks.splice(this.editIndex,
1,a),this.displayBookmarks(),c=!0),c?(this.popup.close(),this.popupState="",this.editIndex=null,c=!1):(a=k.mark(c.repeatFields,g.hitch(this,function(a){return a&&a.name})),new l({message:this.nls[c.errorCode]+a.toString()}))):new l({message:this.nls.warning})},_onEditClose:function(){this.popup=this.edit=null},_createmarkItems:function(){for(var a=0;a<this.bookmarks.length;a++){var c=this._createmarkItem(this.bookmarks[a]);f.place(c,this.bookmarksDiv)}},_createmarkItem:function(a){var c=f.toDom("\x3cdiv class\x3d'mark-item-div jimu-float-leading jimu-leading-margin2'\x3e\x3cdiv class\x3d'mark-item-bg'\x3e\x3cimg class\x3d'mark-item-thumbnail'\x3e\x3cdiv class\x3d'mark-item-delete-icon'\x3e\x3c/div\x3e\x3cdiv class\x3d'mark-item-detail-icon'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'mark-item-title-wapper'\x3e\x3cspan class\x3d'mark-item-title'\x3e\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e"),
v=d(".mark-item-thumbnail",c)[0],e=d(".mark-item-title",c)[0],t=d(".mark-item-delete-icon",c)[0];this.own(n(t,"click",g.hitch(this,this._onmarkItemDeleteClick,a.displayName)));t=d(".mark-item-detail-icon",c)[0];this.own(n(t,"click",g.hitch(this,this._onmarkItemEditClick,a.displayName)));c.item=a;t=a.thumbnail?b.processUrlInWidgetConfig(a.thumbnail,this.folderUrl):this.folderUrl+"images/thumbnail_default.png";f.setAttr(v,"src",t);e.innerHTML=b.sanitizeHTML(a.displayName);f.setAttr(e,"title",a.displayName);
return c},_clearBasemarksDiv:function(){for(var a=d(".mark-item-div",this.domNode),c=0;c<a.length;c++)f.destroy(a[c])},_onmarkItemEditClick:function(a){this._onEditClick(a)},_onmarkItemDeleteClick:function(a){this.getBookmarkByName(a);null!==this.editIndex&&this.bookmarks.splice(this.editIndex,1);this.displayBookmarks()},_processDuplicateName:function(a){var c=[],b={};k.forEach(a,function(a){var d=a.name;d in b?b[d]++:b[d]=0;if(0<b[d]){var e=d+"("+b[d]+")";e in b?(b[e]++,b[d]++):b[e]=0;a.displayName=
0<b[e]?d+"("+b[d]+")":e}else a.displayName=d;c.push(a)},this);a=c}})});